<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Mekhala Kumar &amp; Roy Yoon">
<meta name="dcterms.date" content="2023-05-23">

<title>Mekhala Kumar - Mind your metals: Exploring the Impact of Heavy Metals on Depression with Machine Learning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Mekhala Kumar</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../ProjectsinR.html">Projects in R</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#mind-your-metals-exploring-the-impact-of-heavy-metals-on-depression-with-machine-learning" id="toc-mind-your-metals-exploring-the-impact-of-heavy-metals-on-depression-with-machine-learning" class="nav-link active" data-scroll-target="#mind-your-metals-exploring-the-impact-of-heavy-metals-on-depression-with-machine-learning">Mind Your Metals: Exploring the Impact of Heavy Metals on Depression with Machine Learning</a></li>
  <li><a href="#national-health-and-nutrition-examination-survey-2005-2006" id="toc-national-health-and-nutrition-examination-survey-2005-2006" class="nav-link" data-scroll-target="#national-health-and-nutrition-examination-survey-2005-2006">National Health and Nutrition Examination Survey 2005-2006</a></li>
  <li><a href="#mind-your-metals-exploring-the-impact-of-heavy-metals-on-depression-with-machine-learning-1" id="toc-mind-your-metals-exploring-the-impact-of-heavy-metals-on-depression-with-machine-learning-1" class="nav-link" data-scroll-target="#mind-your-metals-exploring-the-impact-of-heavy-metals-on-depression-with-machine-learning-1">Mind Your Metals: Exploring the Impact of Heavy Metals on Depression with Machine Learning</a>
  <ul class="collapse">
  <li><a href="#machine-learning-within-studies-of-early-life-environmental-exposures-and-child-health-review-of-the-current-literature-and-discussion-of-next-steps" id="toc-machine-learning-within-studies-of-early-life-environmental-exposures-and-child-health-review-of-the-current-literature-and-discussion-of-next-steps" class="nav-link" data-scroll-target="#machine-learning-within-studies-of-early-life-environmental-exposures-and-child-health-review-of-the-current-literature-and-discussion-of-next-steps">Machine Learning within Studies of Early-life Environmental Exposures and Child Health: Review of the current literature and discussion of next-steps</a></li>
  <li><a href="#machine-learning-model-for-depression-based-on-heavy-metals-among-aging-people-a-study-with-national-health-and-nutrition-examination-survey-20172018" id="toc-machine-learning-model-for-depression-based-on-heavy-metals-among-aging-people-a-study-with-national-health-and-nutrition-examination-survey-20172018" class="nav-link" data-scroll-target="#machine-learning-model-for-depression-based-on-heavy-metals-among-aging-people-a-study-with-national-health-and-nutrition-examination-survey-20172018">Machine learning model for depression based on heavy metals among aging people: A study with National Health and Nutrition Examination Survey 2017â€“2018</a></li>
  <li><a href="#association-of-urinary-heavy-metals-co-exposure-and-adult-depression-modification-of-physical-activity" id="toc-association-of-urinary-heavy-metals-co-exposure-and-adult-depression-modification-of-physical-activity" class="nav-link" data-scroll-target="#association-of-urinary-heavy-metals-co-exposure-and-adult-depression-modification-of-physical-activity">Association of urinary heavy metals co-exposure and adult depression: Modification of physical activity</a></li>
  </ul></li>
  <li><a href="#research-question" id="toc-research-question" class="nav-link" data-scroll-target="#research-question"><strong>Research Question:</strong></a>
  <ul class="collapse">
  <li><a href="#independent-variables" id="toc-independent-variables" class="nav-link" data-scroll-target="#independent-variables"><u><strong>Independent Variable(s):</strong></u></a></li>
  <li><a href="#dependent-variable" id="toc-dependent-variable" class="nav-link" data-scroll-target="#dependent-variable"><u><strong>Dependent Variable</strong></u></a></li>
  </ul></li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis">Exploratory Data Analysis</a>
  <ul class="collapse">
  <li><a href="#tidying-data" id="toc-tidying-data" class="nav-link" data-scroll-target="#tidying-data">Tidying Data</a>
  <ul class="collapse">
  <li><a href="#ds1-demographics" id="toc-ds1-demographics" class="nav-link" data-scroll-target="#ds1-demographics"><strong>DS1: Demographics</strong></a></li>
  <li><a href="#ds102-blood-lead-and-blood-cadmium" id="toc-ds102-blood-lead-and-blood-cadmium" class="nav-link" data-scroll-target="#ds102-blood-lead-and-blood-cadmium">DS102: Blood Lead and Blood Cadmium</a></li>
  <li><a href="#ds130-blood-total-mercury-and-blood-inorganic-mercury" id="toc-ds130-blood-total-mercury-and-blood-inorganic-mercury" class="nav-link" data-scroll-target="#ds130-blood-total-mercury-and-blood-inorganic-mercury">DS130: Blood Total Mercury and Blood Inorganic Mercury</a></li>
  <li><a href="#ds209-depression-screener" id="toc-ds209-depression-screener" class="nav-link" data-scroll-target="#ds209-depression-screener">DS209: Depression Screener</a></li>
  </ul></li>
  <li><a href="#join-data-frames" id="toc-join-data-frames" class="nav-link" data-scroll-target="#join-data-frames">Join Data Frames</a></li>
  <li><a href="#exploring-relationships" id="toc-exploring-relationships" class="nav-link" data-scroll-target="#exploring-relationships">Exploring Relationships</a></li>
  <li><a href="#summary-statistics" id="toc-summary-statistics" class="nav-link" data-scroll-target="#summary-statistics">Summary Statistics</a></li>
  <li><a href="#heavy-metal-average-between-male-female" id="toc-heavy-metal-average-between-male-female" class="nav-link" data-scroll-target="#heavy-metal-average-between-male-female">Heavy Metal Average: Between Male &amp; Female</a></li>
  </ul></li>
  <li><a href="#data-split-train80-and-test20" id="toc-data-split-train80-and-test20" class="nav-link" data-scroll-target="#data-split-train80-and-test20">Data Split: Train(80%) and Test(20%)</a></li>
  <li><a href="#training-data" id="toc-training-data" class="nav-link" data-scroll-target="#training-data">Training Data</a></li>
  <li><a href="#evaluation-metric" id="toc-evaluation-metric" class="nav-link" data-scroll-target="#evaluation-metric">Evaluation Metric</a>
  <ul class="collapse">
  <li><a href="#knn" id="toc-knn" class="nav-link" data-scroll-target="#knn">KNN</a></li>
  <li><a href="#random-forest" id="toc-random-forest" class="nav-link" data-scroll-target="#random-forest">Random Forest</a></li>
  <li><a href="#support-vector-machine-svmradial" id="toc-support-vector-machine-svmradial" class="nav-link" data-scroll-target="#support-vector-machine-svmradial">Support Vector Machine svmRadial</a></li>
  <li><a href="#support-vector-machine-svmlinear" id="toc-support-vector-machine-svmlinear" class="nav-link" data-scroll-target="#support-vector-machine-svmlinear">Support Vector Machine svmLinear</a></li>
  <li><a href="#knn-for-all-training-data" id="toc-knn-for-all-training-data" class="nav-link" data-scroll-target="#knn-for-all-training-data">KNN for all Training Data</a></li>
  </ul></li>
  <li><a href="#test-data" id="toc-test-data" class="nav-link" data-scroll-target="#test-data">Test Data</a>
  <ul class="collapse">
  <li><a href="#prediction-on-test-data" id="toc-prediction-on-test-data" class="nav-link" data-scroll-target="#prediction-on-test-data">Prediction on Test Data</a></li>
  </ul></li>
  <li><a href="#comparing-models" id="toc-comparing-models" class="nav-link" data-scroll-target="#comparing-models"><strong>Comparing Models</strong></a></li>
  <li><a href="#ethical-consideration" id="toc-ethical-consideration" class="nav-link" data-scroll-target="#ethical-consideration">Ethical Consideration</a></li>
  <li><a href="#concluding-remarks" id="toc-concluding-remarks" class="nav-link" data-scroll-target="#concluding-remarks">Concluding Remarks</a></li>
  <li><a href="#sources-referenced" id="toc-sources-referenced" class="nav-link" data-scroll-target="#sources-referenced"><strong>Sources Referenced</strong>:</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Mind your metals: Exploring the Impact of Heavy Metals on Depression with Machine Learning</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Mekhala Kumar &amp; Roy Yoon </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 23, 2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreign)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(yardstick)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">warning=</span><span class="cn">FALSE</span>, <span class="at">message=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="mind-your-metals-exploring-the-impact-of-heavy-metals-on-depression-with-machine-learning" class="level1">
<h1>Mind Your Metals: Exploring the Impact of Heavy Metals on Depression with Machine Learning</h1>
</section>
<section id="national-health-and-nutrition-examination-survey-2005-2006" class="level1">
<h1>National Health and Nutrition Examination Survey 2005-2006</h1>
<p>The <em>National Health and Nutrition Examination Survey</em> (NHANES) is a large and comprehensive dataset that includes information about the health and nutrition status of individuals in the United States. The 2005-2006 dataset (ICPSR 25504) is a nationally representative sample of individuals aged 6 months and older who participated in the survey between 2005 and 2006.</p>
<p>The dataset includes a wide range of variables, including demographic information (age, sex, race/ethnicity, education level), health status (including chronic health conditions and health behaviors such as smoking and physical activity), and measures of nutrition and dietary intake (such as calorie and nutrient intake, dietary patterns, and food frequency). There are also physical measurements such as blood pressure, body mass index (BMI), and waist circumference.</p>
<p>The dataset can be used to answer a wide range of research questions related to public health and nutrition. Some potential insights that can be gained from exploring the dataset include:</p>
<ul>
<li><p>The prevalence of chronic health conditions such as hypertension, diabetes, and obesity in different demographic groups</p></li>
<li><p>The associations between health behaviors (such as smoking and physical activity) and health outcomes</p></li>
<li><p>The dietary patterns and nutrient intake of different demographic groups</p></li>
<li><p>The relationships between nutrition and health outcomes such as cardiovascular disease and diabetes</p></li>
<li><p>The associations between physical measurements such as BMI and waist circumference and health outcomes</p></li>
</ul>
<p>Exploring these and other questions can provide valuable insights into the health status of different populations and can inform public health policies and interventions aimed at improving health outcomes.</p>
</section>
<section id="mind-your-metals-exploring-the-impact-of-heavy-metals-on-depression-with-machine-learning-1" class="level1">
<h1>Mind Your Metals: Exploring the Impact of Heavy Metals on Depression with Machine Learning</h1>
<p>The association between heavy metals and depression has been a topic of interest in scientific research. Studies have investigated the potential relationship between exposure to heavy metals and the development or exacerbation of depressive symptoms. Here are some general observations from the existing literature:</p>
<ol type="1">
<li><p><strong>Lead</strong>: Exposure to lead has been associated with an increased risk of depressive symptoms. Lead is a neurotoxic metal that can affect the central nervous system and disrupt neurotransmitter function, potentially contributing to depressive symptoms.</p></li>
<li><p><strong>Mercury</strong>: Some studies suggest a possible link between mercury exposure and depression. Mercury is a toxic metal that can accumulate in the body, including the brain. It may have adverse effects on mood regulation and neurotransmitter function, potentially contributing to depressive symptoms.</p></li>
<li><p><strong>Cadmium</strong>: Cadmium exposure has been associated with an increased risk of depression in some studies. Cadmium is a toxic metal found in industrial pollutants and tobacco smoke. It may disrupt neuroendocrine function and contribute to the development of depressive symptoms.</p></li>
</ol>
<section id="machine-learning-within-studies-of-early-life-environmental-exposures-and-child-health-review-of-the-current-literature-and-discussion-of-next-steps" class="level2">
<h2 class="anchored" data-anchor-id="machine-learning-within-studies-of-early-life-environmental-exposures-and-child-health-review-of-the-current-literature-and-discussion-of-next-steps">Machine Learning within Studies of Early-life Environmental Exposures and Child Health: Review of the current literature and discussion of next-steps</h2>
<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7483339/">Oskar and Stingone</a> emphasize that while ML methods have been widely used for prediction and classification in other fields, environmental health research has traditionally focused on causal or explanatory modeling. However, with the availability of complex environmental health data and the interest in holistic exposure paradigms such as the exposome, there is a need for analytic methods that can address the unique challenges posed by high-dimensional environmental health data.</p>
<p>Their article explores how researchers have applied ML methods in studies of environmental exposures and childrensâ€™ health. It identifies common themes in these studies, including the analysis of environmental mixtures, exposure prediction and characterization, disease prediction and forecasting, analysis of other complex data, and improvements to causal inference. The review summarizes the strengths and limitations of implementing ML methods in these areas and identifies gaps in the literature.</p>
</section>
<section id="machine-learning-model-for-depression-based-on-heavy-metals-among-aging-people-a-study-with-national-health-and-nutrition-examination-survey-20172018" class="level2">
<h2 class="anchored" data-anchor-id="machine-learning-model-for-depression-based-on-heavy-metals-among-aging-people-a-study-with-national-health-and-nutrition-examination-survey-20172018">Machine learning model for depression based on heavy metals among aging people: A study with National Health and Nutrition Examination Survey 2017â€“2018</h2>
<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC9386350/">Xia et al.</a> aimed to explore the association between depression and blood metal elements using a machine learning model. The study utilized data from the National Health and Nutrition Examination Survey (NHANES) conducted in 2017-2018. A total of 3,247 aging samples were included, and 10 different metals were analyzed, including lead (Pb), mercury (Hg), cadmium (Cd), manganese (Mn), selenium (Se), chromium (Cr), cobalt (Co), inorganic mercury (InHg), methylmercury (MeHg), and ethyl mercury (EtHg).</p>
<p>The study compared eight machine learning algorithms for analyzing the association between metal elements and depression. Among the algorithms tested, XGBoost showed optimal effects and was used for further analysis. The study employed both Poisson regression and the XGBoost model to identify risk factors and predict depression.</p>
<p>The results revealed that out of the 3,247 participants, 344 individuals were diagnosed with depression. In the Poisson regression model, the metals Cd (Î² = 0.22, P = 0.00000941), EtHg (Î² = 3.43, P = 0.003216), and Hg (Î² = -0.15, P = 0.001524) were found to be significantly related to depression. The XGBoost model demonstrated good performance for evaluating depression, with an accuracy of 0.89 (95%CI: 0.87, 0.92), a Kappa value of 0.006, and an area under the curve (AUC) of 0.88. An online XGBoost application for depression prediction was also developed.</p>
<p>The study concluded that blood heavy metals, particularly Cd, EtHg, and Hg, were significantly associated with depression. The prediction of depression using machine learning models was deemed essential.</p>
</section>
<section id="association-of-urinary-heavy-metals-co-exposure-and-adult-depression-modification-of-physical-activity" class="level2">
<h2 class="anchored" data-anchor-id="association-of-urinary-heavy-metals-co-exposure-and-adult-depression-modification-of-physical-activity">Association of urinary heavy metals co-exposure and adult depression: Modification of physical activity</h2>
<p><a href="https://www.sciencedirect.com/science/article/abs/pii/S0161813X23000165">Fu et al.</a> aimed to investigate the association between exposure to a mixture of urinary heavy metals and depression, as well as the potential moderating role of physical activity in this relationship. The study used data from the National Health and Nutrition Examination Survey (NHANES) conducted between 2011 and 2016. Depression was assessed using the Patient Health Questionnaire. Elastic net regression was used to select six heavy metals (cadmium, cobalt, tin, antimony, thallium, and mercury) for further analysis. Binomial logistic regression, generalized additive models, environment risk score (ERS), and weighted quantile sum (WQS) regression were employed to examine the effects of individual and cumulative exposure to these metals on depression risk. The study included 4,212 participants, and the prevalence of depression was 7.40%.</p>
<p>The findings of the study indicated that urinary tin and antimony exposure were independently associated with an increased risk of depression. A linear dose-response relationship between tin exposure and depression risk was also observed. Moreover, cumulative exposure to multiple heavy metals was positively associated with depression risk, with tin, antimony, and cadmium identified as the metals contributing most to the overall mixture effect. Notably, the significant positive association between heavy metal mixture exposure and depression risk was observed primarily in individuals who were inactive in physical activity.</p>
<p>In conclusion, this study demonstrated that combined exposure to urinary heavy metals was associated with an increased risk of depression. However, the detrimental effects of heavy metal exposure on depression risk appeared to be attenuated by engaging in physical activity. These findings have important implications for public health, highlighting the potential role of both heavy metal exposure and physical activity in the development and prevention of depression.</p>
</section>
</section>
<section id="research-question" class="level1">
<h1><strong>Research Question:</strong></h1>
<ul>
<li><em>Mind Your Metals</em> aims to predict how factors such as age, gender, and heavy metals(lead, cadmium, and mercury etc.) can have an affect on oneâ€™s mental health, specifically depression. We will examine this topic as a classification problem.</li>
</ul>
<p>From the <em>National Health and Nutrition Examination Survey</em> we chose to examine:</p>
<section id="independent-variables" class="level2">
<h2 class="anchored" data-anchor-id="independent-variables"><u><strong>Independent Variable(s):</strong></u></h2>
<ul>
<li><p><strong>DS1: Demographics</strong></p>
<ul>
<li><p>Age</p></li>
<li><p>Gender</p></li>
</ul></li>
<li><p><strong>DS102: Blood Lead and Blood Cadmium</strong></p>
<ul>
<li><p>Lead</p></li>
<li><p>Cadmium</p></li>
</ul></li>
<li><p><strong>DS130: Blood Total Mercury and Blood Total Inorganic Mercury</strong></p>
<ul>
<li>Mercury</li>
<li>Inorganic Mercury</li>
</ul></li>
</ul>
</section>
<section id="dependent-variable" class="level2">
<h2 class="anchored" data-anchor-id="dependent-variable"><u><strong>Dependent Variable</strong></u></h2>
<ul>
<li><p><strong>DS209: Depression Screener</strong></p>
<ul>
<li>Feeling down, depressed, or hopeless</li>
</ul></li>
</ul>
</section>
</section>
<section id="exploratory-data-analysis" class="level1">
<h1>Exploratory Data Analysis</h1>
<section id="tidying-data" class="level2">
<h2 class="anchored" data-anchor-id="tidying-data">Tidying Data</h2>
<section id="ds1-demographics" class="level3">
<h3 class="anchored" data-anchor-id="ds1-demographics"><strong>DS1: Demographics</strong></h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># demographic data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>demographic <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(<span class="st">"sleep/DS0001/25504-0001-Data.dta"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(demographic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   SEQN                        SDDSRVYR                          RIDSTATR
1 31127 NHANES 2005-2006 Public Release Both Interviewed and MEC examined
2 31128 NHANES 2005-2006 Public Release Both Interviewed and MEC examined
3 31129 NHANES 2005-2006 Public Release Both Interviewed and MEC examined
4 31130 NHANES 2005-2006 Public Release Both Interviewed and MEC examined
5 31131 NHANES 2005-2006 Public Release Both Interviewed and MEC examined
6 31132 NHANES 2005-2006 Public Release Both Interviewed and MEC examined
                     RIDEXMON RIAGENDR RIDAGEYR RIDAGEMN RIDAGEEX
1    May 1 through October 31     Male        0       11       12
2 November 1 through April 30   Female       11      132      132
3    May 1 through October 31     Male       15      189      190
4    May 1 through October 31   Female       85       NA       NA
5    May 1 through October 31   Female       44      535      536
6    May 1 through October 31     Male       70      842      843
            RIDRETH1 DMQMILIT                                DMDBORN
1 Non-Hispanic White     &lt;NA&gt; Born in 50 US States or Washington, DC
2 Non-Hispanic Black     &lt;NA&gt; Born in 50 US States or Washington, DC
3 Non-Hispanic Black     &lt;NA&gt; Born in 50 US States or Washington, DC
4 Non-Hispanic White       No Born in 50 US States or Washington, DC
5 Non-Hispanic Black       No Born in 50 US States or Washington, DC
6 Non-Hispanic White      Yes Born in 50 US States or Washington, DC
                            DMDCITZN DMDYRSUS   DMDEDUC3
1 Citizen by birth or naturalization     &lt;NA&gt;       &lt;NA&gt;
2 Citizen by birth or naturalization     &lt;NA&gt;  4th Grade
3 Citizen by birth or naturalization     &lt;NA&gt; 10th Grade
4 Citizen by birth or naturalization     &lt;NA&gt;       &lt;NA&gt;
5 Citizen by birth or naturalization     &lt;NA&gt;       &lt;NA&gt;
6 Citizen by birth or naturalization     &lt;NA&gt;       &lt;NA&gt;
                   DMDEDUC2  DMDSCHOL      DMDMARTL DMDHHSIZ DMDFMSIZ
1                      &lt;NA&gt;      &lt;NA&gt;          &lt;NA&gt;        4        4
2                      &lt;NA&gt; In school          &lt;NA&gt;        7        6
3                      &lt;NA&gt; In school Never married        6        6
4 Some College or AA degree      &lt;NA&gt;       Widowed        1        1
5 Some College or AA degree      &lt;NA&gt;       Married        4        4
6 College Graduate or above      &lt;NA&gt;       Married        2        2
            INDHHINC           INDFMINC INDFMPIR                RIDEXPRG
1 $15,000 to $19,999 $15,000 to $19,999     0.75                    &lt;NA&gt;
2 $45,000 to $54,999 $20,000 to $24,999     0.77 SP not pregnant at exam
3 $65,000 to $74,999 $65,000 to $74,999     2.71                    &lt;NA&gt;
4 $15,000 to $19,999 $15,000 to $19,999     1.99                    &lt;NA&gt;
5   $75,000 and Over   $75,000 and Over     4.65 SP not pregnant at exam
6   $75,000 and Over   $75,000 and Over     5.00                    &lt;NA&gt;
  DMDHRGND DMDHRAGE                               DMDHRBRN
1   Female       21 Born in 50 US States or Washington, DC
2     Male       47 Born in 50 US States or Washington, DC
3     Male       41 Born in 50 US States or Washington, DC
4   Female       85 Born in 50 US States or Washington, DC
5     Male       36 Born in 50 US States or Washington, DC
6     Male       70 Born in 50 US States or Washington, DC
                                            DMDHREDU DMDHRMAR
1                 High School Grad/GED or equivalent  Married
2 9-11th Grade (Includes 12th grade with no diploma)     &lt;NA&gt;
3                          Some College or AA degree  Married
4                          Some College or AA degree  Widowed
5                          College Graduate or above  Married
6                          College Graduate or above  Married
                                            DMDHSEDU SIALANG SIAPROXY SIAINTRP
1 9-11th Grade (Includes 12th grade with no diploma) English      Yes       No
2                                               &lt;NA&gt; English      Yes       No
3                          Some College or AA degree English      Yes       No
4                                               &lt;NA&gt; English       No       No
5                          Some College or AA degree English       No       No
6                          College Graduate or above English       No       No
  FIALANG FIAPROXY FIAINTRP MIALANG MIAPROXY MIAINTRP AIALANG  WTINT2YR
1 English       No       No    &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt;    &lt;NA&gt;  6434.950
2 English       No       No English       No       No English  9081.701
3 English       No       No English       No       No English  5316.895
4 English       No       No    &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt;    &lt;NA&gt; 29960.840
5 English       No       No English       No       No English 26457.708
6 English       No       No English       No       No English 32961.510
   WTMEC2YR SDMVPSU SDMVSTRA
1  6571.396       2       44
2  8987.042       1       52
3  5586.719       1       51
4 34030.995       2       46
5 26770.585       1       48
6 35315.539       2       52</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>demographic_select <span class="ot">&lt;-</span> demographic<span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(SEQN, RIAGENDR, RIDAGEYR)<span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">GENDER =</span> RIAGENDR,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">AGE =</span> RIDAGEYR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="ds102-blood-lead-and-blood-cadmium" class="level3">
<h3 class="anchored" data-anchor-id="ds102-blood-lead-and-blood-cadmium">DS102: Blood Lead and Blood Cadmium</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>blood_PBCD <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(<span class="st">"sleep/DS0102/25504-0102-Data.dta"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(blood_PBCD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   SEQN LBXBCD LBDBCDSI LBXBPB LBDBPBSI                        SDDSRVYR
1 31128   0.14     1.25   2.24    0.108 NHANES 2005-2006 Public Release
2 31129   0.24     2.14   0.32    0.015 NHANES 2005-2006 Public Release
3 31130     NA       NA     NA       NA NHANES 2005-2006 Public Release
4 31131   0.14     1.25   1.01    0.049 NHANES 2005-2006 Public Release
5 31132   0.14     1.25   1.86    0.090 NHANES 2005-2006 Public Release
6 31133   0.26     2.31   0.35    0.017 NHANES 2005-2006 Public Release
                           RIDSTATR                    RIDEXMON RIAGENDR
1 Both Interviewed and MEC examined November 1 through April 30   Female
2 Both Interviewed and MEC examined    May 1 through October 31     Male
3 Both Interviewed and MEC examined    May 1 through October 31   Female
4 Both Interviewed and MEC examined    May 1 through October 31   Female
5 Both Interviewed and MEC examined    May 1 through October 31     Male
6 Both Interviewed and MEC examined    May 1 through October 31   Female
  RIDAGEYR RIDAGEMN RIDAGEEX           RIDRETH1 DMQMILIT
1       11      132      132 Non-Hispanic Black     &lt;NA&gt;
2       15      189      190 Non-Hispanic Black     &lt;NA&gt;
3       85       NA       NA Non-Hispanic White       No
4       44      535      536 Non-Hispanic Black       No
5       70      842      843 Non-Hispanic White      Yes
6       16      193      194 Non-Hispanic Black     &lt;NA&gt;
                                 DMDBORN                           DMDCITZN
1 Born in 50 US States or Washington, DC Citizen by birth or naturalization
2 Born in 50 US States or Washington, DC Citizen by birth or naturalization
3 Born in 50 US States or Washington, DC Citizen by birth or naturalization
4 Born in 50 US States or Washington, DC Citizen by birth or naturalization
5 Born in 50 US States or Washington, DC Citizen by birth or naturalization
6 Born in 50 US States or Washington, DC Citizen by birth or naturalization
  DMDYRSUS   DMDEDUC3                  DMDEDUC2  DMDSCHOL      DMDMARTL
1     &lt;NA&gt;  4th Grade                      &lt;NA&gt; In school          &lt;NA&gt;
2     &lt;NA&gt; 10th Grade                      &lt;NA&gt; In school Never married
3     &lt;NA&gt;       &lt;NA&gt; Some College or AA degree      &lt;NA&gt;       Widowed
4     &lt;NA&gt;       &lt;NA&gt; Some College or AA degree      &lt;NA&gt;       Married
5     &lt;NA&gt;       &lt;NA&gt; College Graduate or above      &lt;NA&gt;       Married
6     &lt;NA&gt;  9th Grade                      &lt;NA&gt; In school Never married
  DMDHHSIZ DMDFMSIZ           INDHHINC           INDFMINC INDFMPIR
1        7        6 $45,000 to $54,999 $20,000 to $24,999     0.77
2        6        6 $65,000 to $74,999 $65,000 to $74,999     2.71
3        1        1 $15,000 to $19,999 $15,000 to $19,999     1.99
4        4        4   $75,000 and Over   $75,000 and Over     4.65
5        2        2   $75,000 and Over   $75,000 and Over     5.00
6        3        3   $75,000 and Over   $75,000 and Over     5.00
                 RIDEXPRG DMDHRGND DMDHRAGE
1 SP not pregnant at exam     Male       47
2                    &lt;NA&gt;     Male       41
3                    &lt;NA&gt;   Female       85
4 SP not pregnant at exam     Male       36
5                    &lt;NA&gt;     Male       70
6 SP not pregnant at exam     Male       47
                                DMDHRBRN
1 Born in 50 US States or Washington, DC
2 Born in 50 US States or Washington, DC
3 Born in 50 US States or Washington, DC
4 Born in 50 US States or Washington, DC
5 Born in 50 US States or Washington, DC
6 Born in 50 US States or Washington, DC
                                            DMDHREDU DMDHRMAR
1 9-11th Grade (Includes 12th grade with no diploma)     &lt;NA&gt;
2                          Some College or AA degree  Married
3                          Some College or AA degree  Widowed
4                          College Graduate or above  Married
5                          College Graduate or above  Married
6 9-11th Grade (Includes 12th grade with no diploma)  Married
                   DMDHSEDU SIALANG SIAPROXY SIAINTRP FIALANG FIAPROXY FIAINTRP
1                      &lt;NA&gt; English      Yes       No English       No       No
2 Some College or AA degree English      Yes       No English       No       No
3                      &lt;NA&gt; English       No       No English       No       No
4 Some College or AA degree English       No       No English       No       No
5 College Graduate or above English       No       No English       No       No
6 Some College or AA degree English       No       No English       No       No
  MIALANG MIAPROXY MIAINTRP AIALANG  WTINT2YR  WTMEC2YR SDMVPSU SDMVSTRA
1 English       No       No English  9081.701  8987.042       1       52
2 English       No       No English  5316.895  5586.719       1       51
3    &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt;    &lt;NA&gt; 29960.840 34030.995       2       46
4 English       No       No English 26457.708 26770.585       1       48
5 English       No       No English 32961.510 35315.539       2       52
6 English       No       No English  5635.221  5920.618       1       51</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>blood_PBCD_select <span class="ot">&lt;-</span> blood_PBCD<span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(SEQN, LBXBPB, LBXBCD)<span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">LEAD_UGDL =</span> LBXBPB,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">CADMIUM_UGL =</span> LBXBCD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="ds130-blood-total-mercury-and-blood-inorganic-mercury" class="level3">
<h3 class="anchored" data-anchor-id="ds130-blood-total-mercury-and-blood-inorganic-mercury">DS130: Blood Total Mercury and Blood Inorganic Mercury</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>blood_HGIHG <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(<span class="st">"sleep/DS0130/25504-0130-Data.dta"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(blood_HGIHG)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   SEQN LBXTHG LBDTHGSI                        LBDTHGLC LBXIHG LBDIHGSI
1 31128   0.23     1.15     Below lower detection limit   0.25     1.25
2 31129   0.87     4.34 At or above the detection limit   0.25     1.25
3 31130     NA       NA                            &lt;NA&gt;     NA       NA
4 31131   1.97     9.83 At or above the detection limit   1.90     9.48
5 31132   0.23     1.15     Below lower detection limit   0.25     1.25
6 31133   1.14     5.69 At or above the detection limit   0.25     1.25
                         LBDIHGLC                        SDDSRVYR
1     Below lower detection limit NHANES 2005-2006 Public Release
2     Below lower detection limit NHANES 2005-2006 Public Release
3                            &lt;NA&gt; NHANES 2005-2006 Public Release
4 At or above the detection limit NHANES 2005-2006 Public Release
5     Below lower detection limit NHANES 2005-2006 Public Release
6     Below lower detection limit NHANES 2005-2006 Public Release
                           RIDSTATR                    RIDEXMON RIAGENDR
1 Both Interviewed and MEC examined November 1 through April 30   Female
2 Both Interviewed and MEC examined    May 1 through October 31     Male
3 Both Interviewed and MEC examined    May 1 through October 31   Female
4 Both Interviewed and MEC examined    May 1 through October 31   Female
5 Both Interviewed and MEC examined    May 1 through October 31     Male
6 Both Interviewed and MEC examined    May 1 through October 31   Female
  RIDAGEYR RIDAGEMN RIDAGEEX           RIDRETH1 DMQMILIT
1       11      132      132 Non-Hispanic Black     &lt;NA&gt;
2       15      189      190 Non-Hispanic Black     &lt;NA&gt;
3       85       NA       NA Non-Hispanic White       No
4       44      535      536 Non-Hispanic Black       No
5       70      842      843 Non-Hispanic White      Yes
6       16      193      194 Non-Hispanic Black     &lt;NA&gt;
                                 DMDBORN                           DMDCITZN
1 Born in 50 US States or Washington, DC Citizen by birth or naturalization
2 Born in 50 US States or Washington, DC Citizen by birth or naturalization
3 Born in 50 US States or Washington, DC Citizen by birth or naturalization
4 Born in 50 US States or Washington, DC Citizen by birth or naturalization
5 Born in 50 US States or Washington, DC Citizen by birth or naturalization
6 Born in 50 US States or Washington, DC Citizen by birth or naturalization
  DMDYRSUS   DMDEDUC3                  DMDEDUC2  DMDSCHOL      DMDMARTL
1     &lt;NA&gt;  4th Grade                      &lt;NA&gt; In school          &lt;NA&gt;
2     &lt;NA&gt; 10th Grade                      &lt;NA&gt; In school Never married
3     &lt;NA&gt;       &lt;NA&gt; Some College or AA degree      &lt;NA&gt;       Widowed
4     &lt;NA&gt;       &lt;NA&gt; Some College or AA degree      &lt;NA&gt;       Married
5     &lt;NA&gt;       &lt;NA&gt; College Graduate or above      &lt;NA&gt;       Married
6     &lt;NA&gt;  9th Grade                      &lt;NA&gt; In school Never married
  DMDHHSIZ DMDFMSIZ           INDHHINC           INDFMINC INDFMPIR
1        7        6 $45,000 to $54,999 $20,000 to $24,999     0.77
2        6        6 $65,000 to $74,999 $65,000 to $74,999     2.71
3        1        1 $15,000 to $19,999 $15,000 to $19,999     1.99
4        4        4   $75,000 and Over   $75,000 and Over     4.65
5        2        2   $75,000 and Over   $75,000 and Over     5.00
6        3        3   $75,000 and Over   $75,000 and Over     5.00
                 RIDEXPRG DMDHRGND DMDHRAGE
1 SP not pregnant at exam     Male       47
2                    &lt;NA&gt;     Male       41
3                    &lt;NA&gt;   Female       85
4 SP not pregnant at exam     Male       36
5                    &lt;NA&gt;     Male       70
6 SP not pregnant at exam     Male       47
                                DMDHRBRN
1 Born in 50 US States or Washington, DC
2 Born in 50 US States or Washington, DC
3 Born in 50 US States or Washington, DC
4 Born in 50 US States or Washington, DC
5 Born in 50 US States or Washington, DC
6 Born in 50 US States or Washington, DC
                                            DMDHREDU DMDHRMAR
1 9-11th Grade (Includes 12th grade with no diploma)     &lt;NA&gt;
2                          Some College or AA degree  Married
3                          Some College or AA degree  Widowed
4                          College Graduate or above  Married
5                          College Graduate or above  Married
6 9-11th Grade (Includes 12th grade with no diploma)  Married
                   DMDHSEDU SIALANG SIAPROXY SIAINTRP FIALANG FIAPROXY FIAINTRP
1                      &lt;NA&gt; English      Yes       No English       No       No
2 Some College or AA degree English      Yes       No English       No       No
3                      &lt;NA&gt; English       No       No English       No       No
4 Some College or AA degree English       No       No English       No       No
5 College Graduate or above English       No       No English       No       No
6 Some College or AA degree English       No       No English       No       No
  MIALANG MIAPROXY MIAINTRP AIALANG  WTINT2YR  WTMEC2YR SDMVPSU SDMVSTRA
1 English       No       No English  9081.701  8987.042       1       52
2 English       No       No English  5316.895  5586.719       1       51
3    &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt;    &lt;NA&gt; 29960.840 34030.995       2       46
4 English       No       No English 26457.708 26770.585       1       48
5 English       No       No English 32961.510 35315.539       2       52
6 English       No       No English  5635.221  5920.618       1       51</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>blood_HGIHG_select <span class="ot">&lt;-</span> blood_HGIHG<span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(SEQN, LBXTHG, LBXIHG)<span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">MERCURY_UGL =</span> LBXTHG,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">INORG_MERCURY_UGL =</span> LBXIHG)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="ds209-depression-screener" class="level3">
<h3 class="anchored" data-anchor-id="ds209-depression-screener">DS209: Depression Screener</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>depression <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(<span class="st">"sleep/DS0209/25504-0209-Data.dta"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>unwanted_categories <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Don't know"</span>, <span class="st">"Refused"</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>depression_select <span class="ot">&lt;-</span> depression<span class="sc">%&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(SEQN, DPQ020)<span class="sc">%&gt;%</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">DEPRESSED =</span> DPQ020)<span class="sc">%&gt;%</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(DEPRESSED <span class="sc">%in%</span> unwanted_categories))<span class="sc">%&gt;%</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(DEPRESSED))</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>depression_select<span class="sc">$</span>DEPRESSED<span class="ot">&lt;-</span><span class="fu">droplevels</span>(depression_select<span class="sc">$</span>DEPRESSED)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>depression_select <span class="ot">&lt;-</span> depression_select<span class="sc">%&gt;%</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DEPRESSED =</span> <span class="fu">case_when</span>(</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    DEPRESSED <span class="sc">==</span> <span class="st">"Not at all"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">1</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>depression_select<span class="sc">$</span>DEPRESSED <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(depression_select<span class="sc">$</span>DEPRESSED)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="join-data-frames" class="level2">
<h2 class="anchored" data-anchor-id="join-data-frames">Join Data Frames</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(demographic_select)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   SEQN GENDER AGE
1 31127   Male   0
2 31128 Female  11
3 31129   Male  15
4 31130 Female  85
5 31131 Female  44
6 31132   Male  70</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(blood_PBCD_select)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   SEQN LEAD_UGDL CADMIUM_UGL
1 31128      2.24        0.14
2 31129      0.32        0.24
3 31130        NA          NA
4 31131      1.01        0.14
5 31132      1.86        0.14
6 31133      0.35        0.26</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(blood_HGIHG_select)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   SEQN MERCURY_UGL INORG_MERCURY_UGL
1 31128        0.23              0.25
2 31129        0.87              0.25
3 31130          NA                NA
4 31131        1.97              1.90
5 31132        0.23              0.25
6 31133        1.14              0.25</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(depression_select)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   SEQN DEPRESSED
2 31131         0
3 31132         0
4 31134         0
5 31139         0
6 31143         1
7 31144         0</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merging demographic and blood lead and blood cadmium</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> demographic_select <span class="sc">%&gt;%</span> <span class="fu">inner_join</span>(blood_PBCD_select, <span class="at">by =</span> <span class="fu">join_by</span>(SEQN))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   SEQN GENDER AGE LEAD_UGDL CADMIUM_UGL
1 31128 Female  11      2.24        0.14
2 31129   Male  15      0.32        0.24
3 31130 Female  85        NA          NA
4 31131 Female  44      1.01        0.14
5 31132   Male  70      1.86        0.14
6 31133 Female  16      0.35        0.26</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merging demographic and blood lead and blood cadmium and blood total mercury and blood inorganic mercury </span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> a <span class="sc">%&gt;%</span> <span class="fu">inner_join</span>(blood_HGIHG_select, <span class="at">by =</span> <span class="fu">join_by</span>(SEQN))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   SEQN GENDER AGE LEAD_UGDL CADMIUM_UGL MERCURY_UGL INORG_MERCURY_UGL
1 31128 Female  11      2.24        0.14        0.23              0.25
2 31129   Male  15      0.32        0.24        0.87              0.25
3 31130 Female  85        NA          NA          NA                NA
4 31131 Female  44      1.01        0.14        1.97              1.90
5 31132   Male  70      1.86        0.14        0.23              0.25
6 31133 Female  16      0.35        0.26        1.14              0.25</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merging demographic and blood lead and blood cadmium and blood total mercury and blood inorganic mercury and depression screener</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>final_select <span class="ot">&lt;-</span> b <span class="sc">%&gt;%</span> <span class="fu">inner_join</span>(depression_select, <span class="at">by =</span> <span class="fu">join_by</span>(SEQN))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co">#LEAD_UGDL has a measurement tag of UGDL to correspond with the original NHANES data.</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(final_select)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   SEQN GENDER AGE LEAD_UGDL CADMIUM_UGL MERCURY_UGL INORG_MERCURY_UGL
1 31131 Female  44      1.01        0.14        1.97              1.90
2 31132   Male  70      1.86        0.14        0.23              0.25
3 31134   Male  73      1.85        0.14        1.87              0.53
4 31139 Female  18        NA          NA          NA                NA
5 31143   Male  19      0.87        0.14        0.43              0.25
6 31144   Male  21      1.59        0.14        1.49              0.25
  DEPRESSED
1         0
2         0
3         0
4         0
5         1
6         0</code></pre>
</div>
</div>
</section>
<section id="exploring-relationships" class="level2">
<h2 class="anchored" data-anchor-id="exploring-relationships">Exploring Relationships</h2>
</section>
<section id="summary-statistics" class="level2">
<h2 class="anchored" data-anchor-id="summary-statistics">Summary Statistics</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4831 rows and 8 columns</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(final_select)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4831    8</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summarytools<span class="sc">::</span><span class="fu">dfSummary</span>(final_select,</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">varnumbers =</span> <span class="cn">FALSE</span>,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">plain.ascii  =</span> <span class="cn">FALSE</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">style        =</span> <span class="st">"grid"</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">graph.magnif =</span> <span class="fl">0.70</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">valid.col    =</span> <span class="cn">FALSE</span>),</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">'render'</span>,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">table.classes =</span> <span class="st">'table-condensed'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="container st-container">
<h3 class="anchored">Data Frame Summary</h3>
<h4 class="anchored">final_select</h4>
<strong>Dimensions</strong>: 4831 x 8
  <br><strong>Duplicates</strong>: 0
<br>
<table class="table table-striped table-bordered st-table st-table-striped st-table-bordered st-multiline table-condensed">
  <thead>
    <tr>
      <th align="center" class="st-protect-top-border"><strong>Variable</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Stats / Values</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Freqs (% of Valid)</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Graph</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Missing</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td align="left">SEQN
[integer]</td>
      <td align="left" style="padding:8;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">Mean (sd) : 36345.1 (2975.1)</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">min â‰¤ med â‰¤ max:</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">31131 â‰¤ 36344 â‰¤ 41473</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">IQR (CV) : 5113 (0.1)</td></tr></tbody></table></td>
      <td align="left" style="vertical-align:middle">4831 distinct values</td>
      <td align="left" style="vertical-align:middle;padding:0;background-color:transparent;"><img style="border:none;background-color:transparent;padding:0;max-width:max-content;" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAG0AAABPBAMAAAATslZYAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAD1BMVEX////9/v2mpqbw8PD///+xh0SBAAAAAnRSTlMAAHaTzTgAAAABYktHRACIBR1IAAAAB3RJTUUH6AEQAioK14C8OAAAAH1JREFUWMPt1dENgCAMBFBGECcQ3AD2303apEYKKPKl5C4xsck9U/jRmPljdVaf4mwrS9PFFHf9COfWcYPcWadhT0+QLaqOG1LNhiBbaMcbjbioq88uP0m/KxvzuOL6O129AQcHBwf3Z0f/hG3A0QscHBwcHNyXnH8ZcTPnADO0aB1BBYiCAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDI0LTAxLTE2VDAyOjQyOjEwKzAwOjAwSzLBZwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyNC0wMS0xNlQwMjo0MjoxMCswMDowMDpvedsAAAAASUVORK5CYII="></td>
      <td align="center">0
(0.0%)</td>
    </tr>
    <tr>
      <td align="left">GENDER
[factor]</td>
      <td align="left" style="padding:8;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">1. Male</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">2. Female</td></tr></tbody></table></td>
      <td align="left" style="padding:0;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0 5px 0 7px;margin:0;border:0" align="right">2327</td><td style="padding:0 2px 0 0;border:0;" align="left">(</td><td style="padding:0;border:0" align="right">48.2%</td><td style="padding:0 4px 0 2px;border:0" align="left">)</td></tr><tr style="background-color:transparent"><td style="padding:0 5px 0 7px;margin:0;border:0" align="right">2504</td><td style="padding:0 2px 0 0;border:0;" align="left">(</td><td style="padding:0;border:0" align="right">51.8%</td><td style="padding:0 4px 0 2px;border:0" align="left">)</td></tr></tbody></table></td>
      <td align="left" style="vertical-align:middle;padding:0;background-color:transparent;"><img style="border:none;background-color:transparent;padding:0;max-width:max-content;" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAEMAAAAnBAMAAACmgegMAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAD1BMVEX////9/v2mpqbw8PD///+xh0SBAAAAAnRSTlMAAHaTzTgAAAABYktHRACIBR1IAAAAB3RJTUUH6AEQAioK14C8OAAAADZJREFUOMtjYBhcQAkXUBQUgCpRNsYBRpUMGiVERKMgbkBdJUq4gQIhHxkbjyoZJEqIiMbBAgCny5OOE8oQlgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyNC0wMS0xNlQwMjo0MjoxMCswMDowMEsywWcAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjQtMDEtMTZUMDI6NDI6MTArMDA6MDA6b3nbAAAAAElFTkSuQmCC"></td>
      <td align="center">0
(0.0%)</td>
    </tr>
    <tr>
      <td align="left">AGE
[integer]</td>
      <td align="left" style="padding:8;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">Mean (sd) : 44.9 (19.9)</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">min â‰¤ med â‰¤ max:</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">18 â‰¤ 43 â‰¤ 85</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">IQR (CV) : 34 (0.4)</td></tr></tbody></table></td>
      <td align="left" style="vertical-align:middle">68 distinct values</td>
      <td align="left" style="vertical-align:middle;padding:0;background-color:transparent;"><img style="border:none;background-color:transparent;padding:0;max-width:max-content;" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAG0AAABPBAMAAAATslZYAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAD1BMVEX////9/v2mpqbw8PD///+xh0SBAAAAAnRSTlMAAHaTzTgAAAABYktHRACIBR1IAAAAB3RJTUUH6AEQAioK14C8OAAAAJVJREFUWMPt1NsNgCAMBVBGUCdQ2MDuv5tNqEFeQkk02vT+yM+xSblqjPxYzMzIRM4B7OrUqQuO8yldHWdk4nDkNuIAQN03XN8fOHfU1AavukbRyw5nufvWlV14/MXRWrPttlxtuwJd1AKGi27lSUdtZbu0PQu+aB1xeHrH+Zrynd+ubIerGXL+pE6dOnW9zjJzOsk5ABBN3N1YBnuwAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDI0LTAxLTE2VDAyOjQyOjEwKzAwOjAwSzLBZwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyNC0wMS0xNlQwMjo0MjoxMCswMDowMDpvedsAAAAASUVORK5CYII="></td>
      <td align="center">0
(0.0%)</td>
    </tr>
    <tr>
      <td align="left">LEAD_UGDL
[numeric]</td>
      <td align="left" style="padding:8;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">Mean (sd) : 1.8 (1.8)</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">min â‰¤ med â‰¤ max:</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">0.2 â‰¤ 1.4 â‰¤ 55.2</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">IQR (CV) : 1.4 (1)</td></tr></tbody></table></td>
      <td align="left" style="vertical-align:middle">573 distinct values</td>
      <td align="left" style="vertical-align:middle;padding:0;background-color:transparent;"><img style="border:none;background-color:transparent;padding:0;max-width:max-content;" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAG0AAABPBAMAAAATslZYAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAD1BMVEX////9/v2mpqbw8PD///+xh0SBAAAAAnRSTlMAAHaTzTgAAAABYktHRACIBR1IAAAAB3RJTUUH6AEQAioLoIeMrgAAAEZJREFUWMPt17ENACAMA0GPABtAGCH77wYFSJSkQ9F/f3JtKX+26vW9st1wdxwOh8PhcDgcDofD4X5ykY97u8jmcRasKX8T54EPyEyo/+kAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjQtMDEtMTZUMDI6NDI6MTErMDA6MDDtRcrTAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDI0LTAxLTE2VDAyOjQyOjExKzAwOjAwnBhybwAAAABJRU5ErkJggg=="></td>
      <td align="center">192
(4.0%)</td>
    </tr>
    <tr>
      <td align="left">CADMIUM_UGL
[numeric]</td>
      <td align="left" style="padding:8;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">Mean (sd) : 0.5 (0.6)</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">min â‰¤ med â‰¤ max:</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">0.1 â‰¤ 0.3 â‰¤ 10.8</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">IQR (CV) : 0.4 (1.2)</td></tr></tbody></table></td>
      <td align="left" style="vertical-align:middle">272 distinct values</td>
      <td align="left" style="vertical-align:middle;padding:0;background-color:transparent;"><img style="border:none;background-color:transparent;padding:0;max-width:max-content;" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAG0AAABPBAMAAAATslZYAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAD1BMVEX////9/v2mpqbw8PD///+xh0SBAAAAAnRSTlMAAHaTzTgAAAABYktHRACIBR1IAAAAB3RJTUUH6AEQAioLoIeMrgAAAEpJREFUWMPt10ENACAMBMFKAAdQHFD/3qAJ/IEfzW5yzxFwIvHTWc3npeWameFwOBwOh8PhcDgc7i/nH1AfnK9Hd4cHeTu9rEj8BokSElKdXl/CAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDI0LTAxLTE2VDAyOjQyOjExKzAwOjAw7UXK0wAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyNC0wMS0xNlQwMjo0MjoxMSswMDowMJwYcm8AAAAASUVORK5CYII="></td>
      <td align="center">192
(4.0%)</td>
    </tr>
    <tr>
      <td align="left">MERCURY_UGL
[numeric]</td>
      <td align="left" style="padding:8;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">Mean (sd) : 1.4 (1.9)</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">min â‰¤ med â‰¤ max:</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">0.1 â‰¤ 0.9 â‰¤ 33.2</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">IQR (CV) : 1.2 (1.3)</td></tr></tbody></table></td>
      <td align="left" style="vertical-align:middle">584 distinct values</td>
      <td align="left" style="vertical-align:middle;padding:0;background-color:transparent;"><img style="border:none;background-color:transparent;padding:0;max-width:max-content;" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAG0AAABPBAMAAAATslZYAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAD1BMVEX////9/v2mpqbw8PD///+xh0SBAAAAAnRSTlMAAHaTzTgAAAABYktHRACIBR1IAAAAB3RJTUUH6AEQAioLoIeMrgAAAFRJREFUWMPt17ENgDAMRFGPEDaAY4N4/93SpAiiyRVIyPq/f7rClSPqJ+lwatPd2XE4HA6Hw+FwOBzua2e9LItLZxL3R7d/+qfbn3w56XKczM6o3wCazwbleiWmogAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyNC0wMS0xNlQwMjo0MjoxMSswMDowMO1FytMAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjQtMDEtMTZUMDI6NDI6MTErMDA6MDCcGHJvAAAAAElFTkSuQmCC"></td>
      <td align="center">192
(4.0%)</td>
    </tr>
    <tr>
      <td align="left">INORG_MERCURY_UGL
[numeric]</td>
      <td align="left" style="padding:8;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">Mean (sd) : 0.3 (0.4)</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">min â‰¤ med â‰¤ max:</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">0.2 â‰¤ 0.2 â‰¤ 15</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">IQR (CV) : 0.1 (1)</td></tr></tbody></table></td>
      <td align="left" style="vertical-align:middle">98 distinct values</td>
      <td align="left" style="vertical-align:middle;padding:0;background-color:transparent;"><img style="border:none;background-color:transparent;padding:0;max-width:max-content;" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAG0AAABPBAMAAAATslZYAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAD1BMVEX////9/v2mpqbw8PD///+xh0SBAAAAAnRSTlMAAHaTzTgAAAABYktHRACIBR1IAAAAB3RJTUUH6AEQAioLoIeMrgAAADdJREFUWMPty7EBABAMALCewAfUCf3/N4sHrCR7It6XmbNfaOetKs/zPM/zPM/zPM/79uWlEe/b4zoF0fVz2eoAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjQtMDEtMTZUMDI6NDI6MTErMDA6MDDtRcrTAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDI0LTAxLTE2VDAyOjQyOjExKzAwOjAwnBhybwAAAABJRU5ErkJggg=="></td>
      <td align="center">198
(4.1%)</td>
    </tr>
    <tr>
      <td align="left">DEPRESSED
[factor]</td>
      <td align="left" style="padding:8;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">1. 0</td></tr><tr style="background-color:transparent"><td style="padding:0;margin:0;border:0" align="left">2. 1</td></tr></tbody></table></td>
      <td align="left" style="padding:0;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tbody><tr style="background-color:transparent"><td style="padding:0 5px 0 7px;margin:0;border:0" align="right">3769</td><td style="padding:0 2px 0 0;border:0;" align="left">(</td><td style="padding:0;border:0" align="right">78.0%</td><td style="padding:0 4px 0 2px;border:0" align="left">)</td></tr><tr style="background-color:transparent"><td style="padding:0 5px 0 7px;margin:0;border:0" align="right">1062</td><td style="padding:0 2px 0 0;border:0;" align="left">(</td><td style="padding:0;border:0" align="right">22.0%</td><td style="padding:0 4px 0 2px;border:0" align="left">)</td></tr></tbody></table></td>
      <td align="left" style="vertical-align:middle;padding:0;background-color:transparent;"><img style="border:none;background-color:transparent;padding:0;max-width:max-content;" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAF4AAAAnBAMAAAB00eJUAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAD1BMVEX////9/v2mpqbw8PD///+xh0SBAAAAAnRSTlMAAHaTzTgAAAABYktHRACIBR1IAAAAB3RJTUUH6AEQAioLoIeMrgAAADhJREFUOMtjYBj6QIlYAFWvbEwcMBpVP6oei3pS05sgsYBO6pGdSIx6pPAxGlU/qp5U9aSmt6EMAGUqrlLm0nraAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDI0LTAxLTE2VDAyOjQyOjExKzAwOjAw7UXK0wAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyNC0wMS0xNlQwMjo0MjoxMSswMDowMJwYcm8AAAAASUVORK5CYII="></td>
      <td align="center">0
(0.0%)</td>
    </tr>
  </tbody>
</table>
<p>Generated by <a href="https://github.com/dcomtois/summarytools">summarytools</a> 1.0.1 (<a href="https://www.r-project.org/">R</a> version 4.3.2)<br>2024-01-15</p>
</div>
</div>
</div>
<ol type="1">
<li>LEAD_UGDL:
<ul>
<li>Mean in group 0 (non-depressed): 1.816518</li>
<li>Mean in group 1 (depressed): 1.811838</li>
<li>The difference in means between the two groups is not statistically significant (p-value = 0.9397). The 95% confidence interval for the difference spans from -0.1166816 to 0.1260427.</li>
</ul></li>
<li>CADMIUM_UGL:
<ul>
<li>Mean in group 0 (non-depressed): 0.4885205</li>
<li>Mean in group 1 (depressed): 0.5977713</li>
<li>The difference in means between the two groups is statistically significant (p-value = 1.464e-06). The 95% confidence interval for the difference ranges from -0.15357010 to -0.06493149.</li>
</ul></li>
<li>MERCURY_UGL:
<ul>
<li>Mean in group 0 (non-depressed): 1.496233</li>
<li>Mean in group 1 (depressed): 1.228055</li>
<li>The difference in means between the two groups is statistically significant (p-value = 2.567e-06). The 95% confidence interval for the difference is between 0.1566488 and 0.3797086.</li>
</ul></li>
<li>INORG_MERCURY_UGL:
<ul>
<li>Mean in group 0 (non-depressed): 0.3450734</li>
<li>Mean in group 1 (depressed): 0.3349219</li>
<li>The difference in means between the two groups is not statistically significant (p-value = 0.2626). The 95% confidence interval for the difference spans from -0.007614401 to 0.027917506.</li>
</ul></li>
</ol>
<p>These results suggest that there are statistically significant differences in the mean levels of CADMIUM_UGL and MERCURY_UGL between depressed and non-depressed groups. However, there are no significant differences in the mean levels of LEAD_UGDL and INORG_MERCURY_UGL between the two groups.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(LEAD_UGDL <span class="sc">~</span> DEPRESSED, <span class="at">data =</span> final_select)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  LEAD_UGDL by DEPRESSED
t = 0.075644, df = 1679.9, p-value = 0.9397
alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
95 percent confidence interval:
 -0.1166816  0.1260427
sample estimates:
mean in group 0 mean in group 1 
       1.816518        1.811838 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(CADMIUM_UGL <span class="sc">~</span> DEPRESSED, <span class="at">data =</span> final_select)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  CADMIUM_UGL by DEPRESSED
t = -4.8353, df = 1524.9, p-value = 1.464e-06
alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
95 percent confidence interval:
 -0.15357010 -0.06493149
sample estimates:
mean in group 0 mean in group 1 
      0.4885205       0.5977713 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(MERCURY_UGL <span class="sc">~</span> DEPRESSED, <span class="at">data =</span> final_select)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  MERCURY_UGL by DEPRESSED
t = 4.7155, df = 2142.2, p-value = 2.567e-06
alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
95 percent confidence interval:
 0.1566488 0.3797086
sample estimates:
mean in group 0 mean in group 1 
       1.496233        1.228055 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(INORG_MERCURY_UGL <span class="sc">~</span> DEPRESSED, <span class="at">data =</span> final_select)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  INORG_MERCURY_UGL by DEPRESSED
t = 1.1204, df = 3158, p-value = 0.2626
alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
95 percent confidence interval:
 -0.007614401  0.027917506
sample estimates:
mean in group 0 mean in group 1 
      0.3450734       0.3349219 </code></pre>
</div>
</div>
</section>
<section id="heavy-metal-average-between-male-female" class="level2">
<h2 class="anchored" data-anchor-id="heavy-metal-average-between-male-female">Heavy Metal Average: Between Male &amp; Female</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#finding the average of heavy metals in males and females </span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>avg_metal <span class="ot">&lt;-</span> final_select<span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(GENDER, DEPRESSED, CADMIUM_UGL, MERCURY_UGL)<span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(GENDER)<span class="sc">%&gt;%</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(DEPRESSED <span class="sc">==</span> <span class="dv">1</span>)<span class="sc">%&gt;%</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">CADMIUM_MEAN =</span> <span class="fu">mean</span>(CADMIUM_UGL, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">MERCURY_MEAN =</span> <span class="fu">mean</span>(MERCURY_UGL, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>avg_metal</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 Ã— 3
  GENDER CADMIUM_MEAN MERCURY_MEAN
  &lt;fct&gt;         &lt;dbl&gt;        &lt;dbl&gt;
1 Male          0.661         1.14
2 Female        0.555         1.29</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>avg_metal_pivot <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(avg_metal, CADMIUM_MEAN<span class="sc">:</span>MERCURY_MEAN, <span class="at">names_to =</span> <span class="st">"MEAN"</span>, <span class="at">values_to =</span> <span class="st">"UGL"</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>avg_metal_pivot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 Ã— 3
  GENDER MEAN           UGL
  &lt;fct&gt;  &lt;chr&gt;        &lt;dbl&gt;
1 Male   CADMIUM_MEAN 0.661
2 Male   MERCURY_MEAN 1.14 
3 Female CADMIUM_MEAN 0.555
4 Female MERCURY_MEAN 1.29 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>mf_avg_metal <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> avg_metal_pivot) <span class="sc">+</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">MEAN</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">UGL</span><span class="st">`</span>, <span class="at">fill =</span> <span class="st">`</span><span class="at">MEAN</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">25</span>,<span class="at">hjust=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>GENDER)<span class="sc">+</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>mf_avg_metal</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Kumar_Yoon_Final_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="data-split-train80-and-test20" class="level1">
<h1>Data Split: Train(80%) and Test(20%)</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>final_select <span class="ot">&lt;-</span> final_select<span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(SEQN, AGE, GENDER, DEPRESSED, CADMIUM_UGL, MERCURY_UGL)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> final_select <span class="sc">%&gt;%</span>dplyr<span class="sc">::</span><span class="fu">sample_frac</span>(<span class="fl">0.8</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>test  <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">anti_join</span>(final_select, train, <span class="at">by =</span> <span class="st">"SEQN"</span>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   SEQN AGE GENDER DEPRESSED CADMIUM_UGL MERCURY_UGL
1 39533  65 Female         0        0.63        0.48
2 41434  36 Female         0        0.20        1.03
3 37256  53   Male         1        0.28        0.39
4 40773  72   Male         0        0.23        2.75
5 40718  82   Male         0        0.54        0.78
6 31709  39   Male         0        0.56        1.51</code></pre>
</div>
</div>
</section>
<section id="training-data" class="level1">
<h1>Training Data</h1>
<p>We decided to impute the missing values with median as the MAX data points were far from the majority of data points based on the quantiles.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#decide to use Median over mean, as the 'Max.' are very far from spread</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      SEQN            AGE           GENDER     DEPRESSED  CADMIUM_UGL     
 Min.   :31131   Min.   :18.00   Male  :1870   0:3031    Min.   : 0.1400  
 1st Qu.:33800   1st Qu.:27.00   Female:1995   1: 834    1st Qu.: 0.2000  
 Median :36309   Median :43.00                           Median : 0.3200  
 Mean   :36328   Mean   :45.08                           Mean   : 0.5078  
 3rd Qu.:38893   3rd Qu.:61.00                           3rd Qu.: 0.5800  
 Max.   :41473   Max.   :85.00                           Max.   :10.8000  
                                                         NA's   :154      
  MERCURY_UGL    
 Min.   : 0.140  
 1st Qu.: 0.470  
 Median : 0.880  
 Mean   : 1.437  
 3rd Qu.: 1.650  
 Max.   :33.200  
 NA's   :154     </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>train<span class="ot">&lt;-</span>train <span class="sc">%&gt;%</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">CADMIUM_UGL =</span> <span class="fu">median</span>(train<span class="sc">$</span>CADMIUM_UGL,<span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">MERCURY_UGL =</span> <span class="fu">median</span>(train<span class="sc">$</span>MERCURY_UGL,<span class="at">na.rm=</span><span class="cn">TRUE</span>)))</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="co">#validation that NA are replaced by median </span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(train))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
</section>
<section id="evaluation-metric" class="level1">
<h1>Evaluation Metric</h1>
<p>F1 score is a commonly used and effective evaluation metric for classification problems, especially when the dataset is imbalanced.</p>
<p>Our dataset presented an imbalance between the depressed and non-depressed individuals.</p>
<section id="knn" class="level2">
<h2 class="anchored" data-anchor-id="knn">KNN</h2>
<p>We tested for different values of k in k-nearest neighbors (KNN) models; k = 1 - 10.</p>
<p>k = 1 gave the best F1 score of 0.9904793</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>train<span class="ot">&lt;-</span>train<span class="sc">%&gt;%</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(GENDER,DEPRESSED,<span class="at">.before=</span>SEQN)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">5</span>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co">#scale the data</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> train<span class="sc">%&gt;%</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>( AGE<span class="sc">:</span>MERCURY_UGL)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span>train<span class="sc">%&gt;%</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(GENDER, DEPRESSED)</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>x_scaled<span class="ot">&lt;-</span><span class="fu">scale</span>(x, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>x_scaled<span class="ot">&lt;-</span><span class="fu">cbind</span>(y,x_scaled)</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>k_list <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">10</span>))</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(k_list) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'K'</span>,<span class="st">'F1'</span>)</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>KNN1 <span class="ot">&lt;-</span> <span class="fu">train</span>(DEPRESSED<span class="sc">~</span>., <span class="at">data =</span> x_scaled, <span class="at">tuneGrid=</span><span class="fu">data.frame</span>(<span class="at">k=</span>i),<span class="at">method =</span> <span class="st">"knn"</span>, <span class="at">trControl=</span>ctrl, <span class="at">tuneLength =</span> <span class="dv">0</span>)</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>KNN1.pred<span class="ot">&lt;-</span><span class="fu">predict</span>(KNN1,x_scaled)</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>cm_KNN1<span class="ot">&lt;-</span><span class="fu">confusionMatrix</span>(KNN1.pred,x_scaled<span class="sc">$</span>DEPRESSED,<span class="at">mode=</span><span class="st">"prec_recall"</span>)</span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> cm_KNN1<span class="sc">$</span>byClass[<span class="st">"F1"</span>]</span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>k_list[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> i</span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>k_list[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> f1</span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a>k_list</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    K        F1
1   1 0.9904793
2   2 0.8991336
3   3 0.9003909
4   4 0.8788636
5   5 0.8832472
6   6 0.8776870
7   7 0.8815592
8   8 0.8801795
9   9 0.8817588
10 10 0.8807937</code></pre>
</div>
</div>
</section>
<section id="random-forest" class="level2">
<h2 class="anchored" data-anchor-id="random-forest">Random Forest</h2>
<p>We observed:</p>
<ol type="1">
<li><p>20 to 100 trees with an increment of 20 in our random forest model</p></li>
<li><p>6 different hyper-parameter control values 1 -6</p></li>
</ol>
<p>Regardless of the number of trees, the best F1 score was obtained through the hyper-parameter value of 1.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set the seed for reproducibility</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># define the number of folds for cross-validation</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>num_folds <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co"># define hyperparameters to optimize</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>ntree_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">20</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">20</span>)</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>mtry_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize variables for storing performance</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ntree =</span> <span class="fu">numeric</span>(),</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mtry =</span> <span class="fu">numeric</span>(),</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mean_f1 =</span> <span class="fu">numeric</span>(),</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>                      <span class="at">SD_f1 =</span> <span class="fu">numeric</span>()</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a><span class="co"># loop over hyperparameters to find the best combination and store performance</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (ntree <span class="cf">in</span> ntree_values) {</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (mtry <span class="cf">in</span> mtry_values) {</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># initialize variable for storing performance across folds</span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>    f1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_folds)</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># loop over folds for cross-validation</span></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (fold <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_folds) {</span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>      <span class="co"># create training and validation sets for current fold</span></span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>      validIndex <span class="ot">&lt;-</span> ((fold <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">nrow</span>(train) <span class="sc">/</span> num_folds) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(fold <span class="sc">*</span> (<span class="fu">nrow</span>(train) <span class="sc">/</span> num_folds))</span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>      valid <span class="ot">&lt;-</span> train[validIndex, ]</span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>      train_rf <span class="ot">&lt;-</span> train[<span class="sc">-</span>validIndex, ]</span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>      <span class="co"># fit the random forest model with the current hyperparameters on the training set</span></span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>      model <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(DEPRESSED <span class="sc">~</span> GENDER <span class="sc">+</span> AGE <span class="sc">+</span> CADMIUM_UGL <span class="sc">+</span> MERCURY_UGL,</span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> train_rf, <span class="at">ntree =</span> ntree, <span class="at">mtry =</span> mtry)</span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Make predictions on test data</span></span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a>      predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> valid)</span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Create a confusion matrix</span></span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a>      confusion_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(predictions, <span class="at">reference =</span> valid<span class="sc">$</span>DEPRESSED)</span>
<span id="cb50-38"><a href="#cb50-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-39"><a href="#cb50-39" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Extract the confusion matrix metrics</span></span>
<span id="cb50-40"><a href="#cb50-40" aria-hidden="true" tabindex="-1"></a>      precision <span class="ot">&lt;-</span> confusion_matrix<span class="sc">$</span>byClass[<span class="st">"Pos Pred Value"</span>]</span>
<span id="cb50-41"><a href="#cb50-41" aria-hidden="true" tabindex="-1"></a>      recall <span class="ot">&lt;-</span> confusion_matrix<span class="sc">$</span>byClass[<span class="st">"Sensitivity"</span>]</span>
<span id="cb50-42"><a href="#cb50-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-43"><a href="#cb50-43" aria-hidden="true" tabindex="-1"></a>      f1[fold] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision <span class="sc">*</span> recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb50-44"><a href="#cb50-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-45"><a href="#cb50-45" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb50-46"><a href="#cb50-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate mean and standard deviation of RMSLE across folds</span></span>
<span id="cb50-47"><a href="#cb50-47" aria-hidden="true" tabindex="-1"></a>    mean_f1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(f1)</span>
<span id="cb50-48"><a href="#cb50-48" aria-hidden="true" tabindex="-1"></a>    SD_f1<span class="ot">&lt;-</span> <span class="fu">sd</span>(f1)</span>
<span id="cb50-49"><a href="#cb50-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># store the performance of the current combination of hyperparameters</span></span>
<span id="cb50-50"><a href="#cb50-50" aria-hidden="true" tabindex="-1"></a>    results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results, <span class="fu">data.frame</span>(<span class="at">ntree =</span> ntree, <span class="at">mtry =</span> mtry, <span class="at">mean_f1 =</span> mean_f1, <span class="at">SD_f1 =</span> SD_f1))</span>
<span id="cb50-51"><a href="#cb50-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">'Completed mtry = '</span>, mtry, <span class="st">'and ntree = '</span>, ntree))</span>
<span id="cb50-52"><a href="#cb50-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">Sys.time</span>())</span>
<span id="cb50-53"><a href="#cb50-53" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-54"><a href="#cb50-54" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Completed mtry =  1 and ntree =  20"
[1] "2024-01-15 21:42:15 EST"
[1] "Completed mtry =  2 and ntree =  20"
[1] "2024-01-15 21:42:16 EST"
[1] "Completed mtry =  3 and ntree =  20"
[1] "2024-01-15 21:42:16 EST"
[1] "Completed mtry =  4 and ntree =  20"
[1] "2024-01-15 21:42:16 EST"
[1] "Completed mtry =  5 and ntree =  20"
[1] "2024-01-15 21:42:17 EST"
[1] "Completed mtry =  6 and ntree =  20"
[1] "2024-01-15 21:42:17 EST"
[1] "Completed mtry =  1 and ntree =  40"
[1] "2024-01-15 21:42:17 EST"
[1] "Completed mtry =  2 and ntree =  40"
[1] "2024-01-15 21:42:18 EST"
[1] "Completed mtry =  3 and ntree =  40"
[1] "2024-01-15 21:42:18 EST"
[1] "Completed mtry =  4 and ntree =  40"
[1] "2024-01-15 21:42:19 EST"
[1] "Completed mtry =  5 and ntree =  40"
[1] "2024-01-15 21:42:20 EST"
[1] "Completed mtry =  6 and ntree =  40"
[1] "2024-01-15 21:42:20 EST"
[1] "Completed mtry =  1 and ntree =  60"
[1] "2024-01-15 21:42:21 EST"
[1] "Completed mtry =  2 and ntree =  60"
[1] "2024-01-15 21:42:22 EST"
[1] "Completed mtry =  3 and ntree =  60"
[1] "2024-01-15 21:42:23 EST"
[1] "Completed mtry =  4 and ntree =  60"
[1] "2024-01-15 21:42:24 EST"
[1] "Completed mtry =  5 and ntree =  60"
[1] "2024-01-15 21:42:25 EST"
[1] "Completed mtry =  6 and ntree =  60"
[1] "2024-01-15 21:42:27 EST"
[1] "Completed mtry =  1 and ntree =  80"
[1] "2024-01-15 21:42:27 EST"
[1] "Completed mtry =  2 and ntree =  80"
[1] "2024-01-15 21:42:29 EST"
[1] "Completed mtry =  3 and ntree =  80"
[1] "2024-01-15 21:42:30 EST"
[1] "Completed mtry =  4 and ntree =  80"
[1] "2024-01-15 21:42:32 EST"
[1] "Completed mtry =  5 and ntree =  80"
[1] "2024-01-15 21:42:33 EST"
[1] "Completed mtry =  6 and ntree =  80"
[1] "2024-01-15 21:42:34 EST"
[1] "Completed mtry =  1 and ntree =  100"
[1] "2024-01-15 21:42:35 EST"
[1] "Completed mtry =  2 and ntree =  100"
[1] "2024-01-15 21:42:37 EST"
[1] "Completed mtry =  3 and ntree =  100"
[1] "2024-01-15 21:42:38 EST"
[1] "Completed mtry =  4 and ntree =  100"
[1] "2024-01-15 21:42:40 EST"
[1] "Completed mtry =  5 and ntree =  100"
[1] "2024-01-15 21:42:42 EST"
[1] "Completed mtry =  6 and ntree =  100"
[1] "2024-01-15 21:42:43 EST"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print the optimal values of hyperparameters</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>best <span class="ot">&lt;-</span> results[<span class="fu">which.min</span>(results<span class="sc">$</span>mean_f1), ]</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal ntree value:"</span>, best<span class="sc">$</span>ntree, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal ntree value: 20 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal mtry value:"</span>, best<span class="sc">$</span>mtry, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Optimal mtry value: 6 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mean f1:"</span>, best<span class="sc">$</span>mean_f1, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mean f1: 0.8415664 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(results, <span class="fu">aes</span>(<span class="at">x =</span> mtry, <span class="at">y =</span> ntree, <span class="at">fill =</span> mean_f1)) <span class="sc">+</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(mean_f1, <span class="dv">3</span>)), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">colour =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"F1 for Random Forest with Varying ntree and mtry"</span>) <span class="sc">+</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"mtry"</span>) <span class="sc">+</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"ntree"</span>) <span class="sc">+</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Kumar_Yoon_Final_files/figure-html/random%20forest-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="support-vector-machine-svmradial" class="level2">
<h2 class="anchored" data-anchor-id="support-vector-machine-svmradial">Support Vector Machine svmRadial</h2>
<p>We observed a sequence of values from 0.1 to 1 with an increment of 0.1 for the width of the RBF kernel. Additionally, we observed a sequence of values from 1 to 10 with an increment of 1 for the regularization parameter in our SVM.</p>
<ul>
<li><p>Best Parameters: sigma = 0.8, C = 1</p></li>
<li><p>F1 Score: 0.881435029896456</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the parameter grid</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>parameter_grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">sigma =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>),</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">C =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span>))</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the SVM model with different parameter combinations</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>svm_model <span class="ot">&lt;-</span> <span class="fu">train</span>(DEPRESSED <span class="sc">~</span> GENDER <span class="sc">+</span> AGE <span class="sc">+</span> CADMIUM_UGL <span class="sc">+</span> MERCURY_UGL, </span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, <span class="at">method =</span> <span class="st">"svmRadial"</span>,</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> ctrl, <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> parameter_grid, <span class="at">metric =</span> <span class="st">"F1"</span>, <span class="at">maximize =</span> <span class="cn">TRUE</span>)</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test data</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(svm_model, <span class="at">newdata =</span> train)</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a confusion matrix</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(predictions, <span class="at">reference =</span> train<span class="sc">$</span>DEPRESSED)</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the F1 score</span></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> confusion_matrix<span class="sc">$</span>byClass[<span class="st">"F1"</span>]</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the best parameter combination and the corresponding F1 score</span></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Best Parameters: sigma ="</span>, svm_model<span class="sc">$</span>bestTune<span class="sc">$</span>sigma, <span class="st">"C ="</span>, svm_model<span class="sc">$</span>bestTune<span class="sc">$</span>C))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Best Parameters: sigma = 0.8 C = 1"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"F1 Score:"</span>, f1_score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "F1 Score: 0.881435029896456"</code></pre>
</div>
</div>
</section>
<section id="support-vector-machine-svmlinear" class="level2">
<h2 class="anchored" data-anchor-id="support-vector-machine-svmlinear">Support Vector Machine svmLinear</h2>
<p>We observed a sequence of values from 1 to 10 with an increment of 1 for the regularization parameter in our SVM.</p>
<ul>
<li><p>Best Parameter: C = 1</p></li>
<li><p>F1 Score: 0.879060324825986</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the parameter grid</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>parameter_grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">C =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span>))</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the SVM model with different parameter combinations</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>svm_model <span class="ot">&lt;-</span> <span class="fu">train</span>(DEPRESSED <span class="sc">~</span> GENDER <span class="sc">+</span> AGE <span class="sc">+</span> CADMIUM_UGL <span class="sc">+</span> MERCURY_UGL, </span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, <span class="at">method =</span> <span class="st">"svmLinear"</span>,</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> ctrl, <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> parameter_grid, <span class="at">metric =</span> <span class="st">"F1"</span>, <span class="at">maximize =</span> <span class="cn">TRUE</span>)</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test data</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(svm_model, <span class="at">newdata =</span> train)</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a confusion matrix</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(predictions, <span class="at">reference =</span> train<span class="sc">$</span>DEPRESSED)</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the F1 score</span></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> confusion_matrix<span class="sc">$</span>byClass[<span class="st">"F1"</span>]</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the best parameter combination and the corresponding F1 score</span></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Best Parameter: C ="</span>, svm_model<span class="sc">$</span>bestTune<span class="sc">$</span>C))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Best Parameter: C = 1"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"F1 Score:"</span>, f1_score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "F1 Score: 0.879060324825986"</code></pre>
</div>
</div>
</section>
<section id="knn-for-all-training-data" class="level2">
<h2 class="anchored" data-anchor-id="knn-for-all-training-data">KNN for all Training Data</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="co">#scale the data</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> train<span class="sc">%&gt;%</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>( AGE<span class="sc">:</span>MERCURY_UGL)</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span>train<span class="sc">%&gt;%</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(GENDER, DEPRESSED)</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>x_scaled<span class="ot">&lt;-</span><span class="fu">scale</span>(x, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>x_scaled<span class="ot">&lt;-</span><span class="fu">cbind</span>(y,x_scaled)</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>KNN_fin <span class="ot">&lt;-</span> <span class="fu">train</span>(DEPRESSED<span class="sc">~</span>., <span class="at">data =</span> x_scaled, <span class="at">tuneGrid=</span><span class="fu">data.frame</span>(<span class="at">k=</span><span class="dv">1</span>),<span class="at">method =</span> <span class="st">"knn"</span>)</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>KNN_fin.pred<span class="ot">&lt;-</span><span class="fu">predict</span>(KNN_fin,x_scaled)</span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>cm_KNN_fin<span class="ot">&lt;-</span><span class="fu">confusionMatrix</span>(KNN_fin.pred,x_scaled<span class="sc">$</span>DEPRESSED,<span class="at">mode=</span><span class="st">"prec_recall"</span>)</span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> cm_KNN_fin<span class="sc">$</span>byClass[<span class="st">"F1"</span>]</span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>f1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       F1 
0.9911417 </code></pre>
</div>
</div>
</section>
</section>
<section id="test-data" class="level1">
<h1>Test Data</h1>
<p>We decided to impute the missing values with median as the max data points were far from the majority of data points based on the quantiles.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>test<span class="ot">&lt;-</span>test<span class="sc">%&gt;%</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(GENDER,DEPRESSED,<span class="at">.before=</span>SEQN)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="co">#decide to use Median over mean, as the MAX are vary far from spread</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    GENDER    DEPRESSED      SEQN            AGE         CADMIUM_UGL    
 Male  :457   0:738     Min.   :31144   Min.   :18.00   Min.   :0.1400  
 Female:509   1:228     1st Qu.:33854   1st Qu.:27.00   1st Qu.:0.2000  
                        Median :36481   Median :43.00   Median :0.3300  
                        Mean   :36413   Mean   :44.29   Mean   :0.5317  
                        3rd Qu.:38998   3rd Qu.:60.00   3rd Qu.:0.5600  
                        Max.   :41466   Max.   :85.00   Max.   :5.7100  
                                                        NA's   :38      
  MERCURY_UGL    
 Min.   : 0.140  
 1st Qu.: 0.470  
 Median : 0.915  
 Mean   : 1.436  
 3rd Qu.: 1.730  
 Max.   :20.900  
 NA's   :38      </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>test<span class="ot">&lt;-</span>test <span class="sc">%&gt;%</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">CADMIUM_UGL =</span> <span class="fu">median</span>(test<span class="sc">$</span>CADMIUM_UGL,<span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">MERCURY_UGL =</span> <span class="fu">median</span>(test<span class="sc">$</span>MERCURY_UGL,<span class="at">na.rm=</span><span class="cn">TRUE</span>)))</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="co">#validation that NA are replaced by median </span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(test))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">#scale</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> test<span class="sc">%&gt;%</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>( AGE<span class="sc">:</span>MERCURY_UGL)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span>test<span class="sc">%&gt;%</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(GENDER, DEPRESSED)</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>x_scaled<span class="ot">&lt;-</span><span class="fu">scale</span>(x, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>x_scaled<span class="ot">&lt;-</span><span class="fu">cbind</span>(y,x_scaled)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="prediction-on-test-data" class="level2">
<h2 class="anchored" data-anchor-id="prediction-on-test-data">Prediction on Test Data</h2>
<ul>
<li><p><strong>KNN F1 Score</strong>: 0.846153846153846</p></li>
<li><p><strong>Random Forest F1 Score</strong>: 0.86454652532391</p></li>
<li><p><strong>SVM radial F1 Score</strong>: 0.864896755162242</p></li>
<li><p><strong>SVM Linear F1 Score</strong>: 0.866197183098592</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>knn_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(KNN_fin, <span class="at">newdata =</span> test)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a confusion matrix for the test predictions</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>knn_confusion_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(knn_predictions, <span class="at">reference =</span> test<span class="sc">$</span>DEPRESSED)</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the F1 score from the test confusion matrix</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>knn_f1_score <span class="ot">&lt;-</span> knn_confusion_matrix<span class="sc">$</span>byClass[<span class="st">"F1"</span>]</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the F1 score for the test set</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"KNN F1 Score:"</span>, knn_f1_score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "KNN F1 Score: 0.846153846153846"</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>rf_fin <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(DEPRESSED <span class="sc">~</span> GENDER <span class="sc">+</span> AGE <span class="sc">+</span> CADMIUM_UGL <span class="sc">+</span> MERCURY_UGL,</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> train_rf, <span class="at">ntree =</span> <span class="dv">20</span>, <span class="at">mtry =</span> <span class="dv">1</span>)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>rf_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_fin, <span class="at">newdata =</span> test)</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a confusion matrix for the test predictions</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>rf_confusion_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(rf_predictions, <span class="at">reference =</span> test<span class="sc">$</span>DEPRESSED)</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the F1 score from the test confusion matrix</span></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>rf_f1_score <span class="ot">&lt;-</span> rf_confusion_matrix<span class="sc">$</span>byClass[<span class="st">"F1"</span>]</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the F1 score for the test set</span></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Random Forest F1 Score:"</span>, rf_f1_score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Random Forest F1 Score: 0.866197183098592"</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>svmrad_model <span class="ot">&lt;-</span> <span class="fu">train</span>(DEPRESSED <span class="sc">~</span> GENDER <span class="sc">+</span> AGE <span class="sc">+</span> CADMIUM_UGL <span class="sc">+</span> MERCURY_UGL, </span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"svmRadial"</span>,</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> ctrl,</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneLength =</span> <span class="dv">1</span>,  <span class="co"># Set the number of hyperparameter combinations to 1</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> <span class="fu">data.frame</span>(<span class="at">sigma =</span> <span class="fl">0.8</span>, <span class="at">C =</span> <span class="dv">1</span>),  <span class="co"># Set sigma and C values</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">"F1"</span>,</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">maximize =</span> <span class="cn">TRUE</span>)</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test data</span></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>svmrad_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(svmrad_model, <span class="at">newdata =</span> test)</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a confusion matrix for the test predictions</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>svmrad_confusion_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(svmrad_predictions, <span class="at">reference =</span> test<span class="sc">$</span>DEPRESSED)</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the F1 score from the test confusion matrix</span></span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>svmrad_f1_score <span class="ot">&lt;-</span> svmrad_confusion_matrix<span class="sc">$</span>byClass[<span class="st">"F1"</span>]</span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the F1 score for the test set</span></span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"SVM Radial F1 Score:"</span>, svmrad_f1_score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "SVM Radial F1 Score: 0.864896755162242"</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>svmlin_model <span class="ot">&lt;-</span> <span class="fu">train</span>(DEPRESSED <span class="sc">~</span> GENDER <span class="sc">+</span> AGE <span class="sc">+</span> CADMIUM_UGL <span class="sc">+</span> MERCURY_UGL, </span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"svmLinear"</span>,</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> ctrl,</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneLength =</span> <span class="dv">1</span>,  <span class="co"># Set the number of hyperparameter combinations to 1</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> <span class="fu">data.frame</span>(<span class="at">C =</span> <span class="dv">1</span>),  <span class="co"># Set the value for C</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">"F1"</span>,</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">maximize =</span> <span class="cn">TRUE</span>)</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test data</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>svmlin_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(svmlin_model, <span class="at">newdata =</span> test)</span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a confusion matrix for the test predictions</span></span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>svmlin_confusion_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(svmlin_predictions, <span class="at">reference =</span> test<span class="sc">$</span>DEPRESSED)</span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the F1 score from the test confusion matrix</span></span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>svmlin_f1_score <span class="ot">&lt;-</span> svmlin_confusion_matrix<span class="sc">$</span>byClass[<span class="st">"F1"</span>]</span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the F1 score for the test set</span></span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"SVM Linear F1 Score:"</span>, svmlin_f1_score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "SVM Linear F1 Score: 0.866197183098592"</code></pre>
</div>
</div>
</section>
</section>
<section id="comparing-models" class="level1">
<h1><strong>Comparing Models</strong></h1>
<ol type="1">
<li>KNN:
<ul>
<li><p>Overfitting and Underfitting:</p>
<ul>
<li>KNN can suffer from overfitting when the value of k is too small, leading to excessive complexity and potentially memorizing the training data. On the other hand, with a large value of k, KNN may underfit and fail to capture the underlying patterns in the data.</li>
</ul></li>
<li><p>Bias vs Variance Tradeoff:</p>
<ul>
<li>KNN tends to have low bias but can have high variance, especially when k is small. As k increases, the model becomes more biased but also reduces its variance.</li>
</ul></li>
<li><p>Flexibility vs Interpretability:</p>
<ul>
<li>KNN is a flexible model that can capture complex relationships in the data. However, it is less interpretable compared to other models as it relies on the similarity of data points rather than explicit rules or coefficients.</li>
</ul></li>
<li><p>In our project, k = 1 gave the best F1 score of 0.9904793. This suggests our model is overfitted and has low bias with high variance. As the value of our k value increases the F1 score decreases.</p></li>
</ul></li>
<li>Random Forest:
<ul>
<li><p>Overfitting and Underfitting:</p>
<ul>
<li>Random Forests are less prone to overfitting due to the ensemble nature of combining multiple decision trees. However, it can still overfit if the number of trees is very large or if individual trees are allowed to grow excessively deep.</li>
</ul></li>
<li><p>Bias vs Variance Tradeoff:</p>
<ul>
<li>Random Forests strike a balance between bias and variance by aggregating multiple decision trees. The individual trees in the ensemble tend to have high variance but when combined, the overall model has lower variance.</li>
</ul></li>
<li><p>Flexibility vs Interpretability:</p>
<ul>
<li>Random Forests offer a good balance between flexibility and interpretability. They can capture complex interactions in the data while also providing feature importances for interpretability.</li>
</ul></li>
<li><p>In our project we observed 20 to 100 trees with an increment of 20 in our random forest model and 6 different hyper-parameter control values of 1 -6. Regardless of the number of trees, the best F1 score was obtained through the hyper-parameter value of 1. As the number of individual trees increase, we notice how our F1 scores decrease, which may suggest that the model does not suffer much overfitting.</p></li>
<li><p>However, we find it interesting that the F1 scores remain consistent when we increment our trees by 20 from 20 - 100. This observation can be further studied to better the random forest model.</p></li>
</ul></li>
<li>SVM (Radial):
<ul>
<li>Overfitting and Underfitting:
<ul>
<li>SVM with a radial kernel can be prone to overfitting if the kernel parameters, such as sigma, are not properly tuned. If the kernel parameters are chosen poorly, the model may fail to generalize well to unseen data.</li>
</ul></li>
<li>Bias vs Variance Tradeoff:
<ul>
<li>SVM with a radial kernel can have a high flexibility and may capture complex patterns in the data. However, if the model is excessively flexible due to incorrect parameter choices, it can have high variance.</li>
</ul></li>
<li>Flexibility vs Interpretability:
<ul>
<li>SVM with a radial kernel is more flexible and can capture non-linear relationships in the data. However, the resulting model may be less interpretable compared to linear models.</li>
</ul></li>
<li>In our project, we observed a sequence of values from 0.1 to 1 with an increment of 0.1 for the width of the RBF kernel. Additionally, we observed a sequence of values from 1 to 10 with an increment of 1 for the regularization parameter in our SVM.</li>
</ul></li>
<li>SVM (Linear):
<ul>
<li>Overfitting and Underfitting:
<ul>
<li>SVM with a linear kernel is less prone to overfitting compared to models with more flexible kernels. However, it can still overfit if the regularization parameter (C) is set too small or if the data has a large number of features compared to the number of samples.</li>
</ul></li>
<li>Bias vs Variance Tradeoff:
<ul>
<li>SVM with a linear kernel tends to have lower variance but can have a higher bias compared to more flexible models. It relies on finding the optimal hyperplane to separate the classes, which may not capture complex relationships.</li>
</ul></li>
<li>Flexibility vs Interpretability:
<ul>
<li>SVM with a linear kernel strikes a balance between flexibility and interpretability. It can capture linear relationships in the data while providing interpretable coefficients for each feature.</li>
</ul></li>
<li>We observed a sequence of values from 1 to 10 with an increment of 1 for the regularization parameter in our SVM. SVM with a radial kernel are more prone to overfitting when compared to SVM with a linear kernel. In general, SVM with a radial kernel is more flexible and can capture non-linear data more aptly. However, in our model we notice how the svmRadial and svmLinear approaches yield virtually the same F1 scores. This could suggest that the data contains linear relationships.</li>
</ul></li>
</ol>
<p>In summary, the Random Forest model generally performs well in terms of overfitting and bias-variance tradeoff due to its ensemble nature. SVM with a linear kernel and KNN also show similar performance in terms of overfitting and bias-variance tradeoff. However, Random Forest and SVM with a radial kernel offer more flexibility in capturing complex patterns, while SVM with a linear kernel provides better interpretability with its coefficients.</p>
</section>
<section id="ethical-consideration" class="level1">
<h1>Ethical Consideration</h1>
<ol type="1">
<li>HIPAA Violation:
<ol type="1">
<li>With the understanding of heavy metals in urine and blood as a predictor of depression, a provider may have bias towards their patients. If a patient received labs for blood or urine analysis, the test may show the levels of heavy metals in their samples. A provider who observes the presence of the metals may form (un)conscious biases towards their patients. This could lead to potential HIPAA violations if a provider that is not in the scope of practice decided to investigate patientsâ€™ non-disclosed mental health status.</li>
</ol></li>
<li>Hazard Transparency:
<ol type="1">
<li>Heavy metals are commonly bio-accumulated through inhalation. Trace amounts of these metals can be IN THE AIR. Workers who are at higher risk of heavy metal inhalation due to their work environment should be properly informed of risk. If predictions between heavy metals and depression are known but obscured from employees, the workers may develop mental health concerns due to their work environment, but be unaware.</li>
</ol></li>
</ol>
</section>
<section id="concluding-remarks" class="level1">
<h1>Concluding Remarks</h1>
<p>We found that there is a statistically significant effect of Cadmium and Mercury between depressed and non-depressed groups. While running the models on the training set, KNN performed the best. However, when we compared the models using the test set, the difference in the F1 scores was minor, though the svmLinear performed slightly better.</p>
</section>
<section id="sources-referenced" class="level1">
<h1><strong>Sources Referenced</strong>:</h1>
<p>ChatGPT, personal communication, May 23, 2023</p>
<p>Oskar S, Stingone JA. Machine Learning Within Studies of Early-Life Environmental Exposures and Child Health: Review of the Current Literature and Discussion of Next Steps. Curr Environ Health Rep.&nbsp;2020 Sep;7(3):170-184. doi: 10.1007/s40572-020-00282-5. PMID: 32578067; PMCID: PMC7483339.</p>
<p>Posit team (2023). RStudio: Integrated Development Environment for R. Posit Software, PBC, Boston, MA. URL http://www.posit.co/.</p>
<p>Xia F, Li Q, Luo X, Wu J. Machine learning model for depression based on heavy metals among aging people: A study with National Health and Nutrition Examination Survey 2017-2018. Front Public Health. 2022 Aug 4;10:939758. doi: 10.3389/fpubh.2022.939758. PMID: 35991018; PMCID: PMC9386350.</p>
<p>Xihang Fu, Huiru Li, Lingling Song, Manqiu Cen, Jing Wu, Association of urinary heavy metals co-exposure and adult depression: Modification of physical activity, NeuroToxicology, Volume 95,2023,Pages 117-12 ISSN 0161-813X,https://doi.org/10.1016/j.neuro.2023.01.008</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb82" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Mind your metals: Exploring the Impact of Heavy Metals on Depression with Machine Learning"</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "05/23/23"</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Mekhala Kumar &amp; Roy Yoon"</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a><span class="an">tags:</span><span class="co"> </span></span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a><span class="co">  - NHANES</span></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a><span class="co">  - Depression</span></span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a><span class="co">  - Heavy metal</span></span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a><span class="co">  - Kumar</span></span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a><span class="co">  - Yoon</span></span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a><span class="co">  - AI</span></span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup}</span></span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb82-23"><a href="#cb82-23" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb82-24"><a href="#cb82-24" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb82-25"><a href="#cb82-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb82-26"><a href="#cb82-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb82-27"><a href="#cb82-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb82-28"><a href="#cb82-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb82-29"><a href="#cb82-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb82-30"><a href="#cb82-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreign)</span>
<span id="cb82-31"><a href="#cb82-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb82-32"><a href="#cb82-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb82-33"><a href="#cb82-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb82-34"><a href="#cb82-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb82-35"><a href="#cb82-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb82-36"><a href="#cb82-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb82-37"><a href="#cb82-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb82-38"><a href="#cb82-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(yardstick)</span>
<span id="cb82-39"><a href="#cb82-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb82-40"><a href="#cb82-40" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">warning=</span><span class="cn">FALSE</span>, <span class="at">message=</span><span class="cn">FALSE</span>)</span>
<span id="cb82-41"><a href="#cb82-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-42"><a href="#cb82-42" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-43"><a href="#cb82-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-44"><a href="#cb82-44" aria-hidden="true" tabindex="-1"></a><span class="fu"># Mind Your Metals: Exploring the Impact of Heavy Metals on Depression with Machine Learning</span></span>
<span id="cb82-45"><a href="#cb82-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-46"><a href="#cb82-46" aria-hidden="true" tabindex="-1"></a><span class="fu"># National Health and Nutrition Examination Survey 2005-2006</span></span>
<span id="cb82-47"><a href="#cb82-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-48"><a href="#cb82-48" aria-hidden="true" tabindex="-1"></a>The *National Health and Nutrition Examination Survey* (NHANES) is a large and comprehensive dataset that includes information about the health and nutrition status of individuals in the United States. The 2005-2006 dataset (ICPSR 25504) is a nationally representative sample of individuals aged 6 months and older who participated in the survey between 2005 and 2006.</span>
<span id="cb82-49"><a href="#cb82-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-50"><a href="#cb82-50" aria-hidden="true" tabindex="-1"></a>The dataset includes a wide range of variables, including demographic information (age, sex, race/ethnicity, education level), health status (including chronic health conditions and health behaviors such as smoking and physical activity), and measures of nutrition and dietary intake (such as calorie and nutrient intake, dietary patterns, and food frequency). There are also physical measurements such as blood pressure, body mass index (BMI), and waist circumference.</span>
<span id="cb82-51"><a href="#cb82-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-52"><a href="#cb82-52" aria-hidden="true" tabindex="-1"></a>The dataset can be used to answer a wide range of research questions related to public health and nutrition. Some potential insights that can be gained from exploring the dataset include:</span>
<span id="cb82-53"><a href="#cb82-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-54"><a href="#cb82-54" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The prevalence of chronic health conditions such as hypertension, diabetes, and obesity in different demographic groups</span>
<span id="cb82-55"><a href="#cb82-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-56"><a href="#cb82-56" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The associations between health behaviors (such as smoking and physical activity) and health outcomes</span>
<span id="cb82-57"><a href="#cb82-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-58"><a href="#cb82-58" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The dietary patterns and nutrient intake of different demographic groups</span>
<span id="cb82-59"><a href="#cb82-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-60"><a href="#cb82-60" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The relationships between nutrition and health outcomes such as cardiovascular disease and diabetes</span>
<span id="cb82-61"><a href="#cb82-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-62"><a href="#cb82-62" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The associations between physical measurements such as BMI and waist circumference and health outcomes</span>
<span id="cb82-63"><a href="#cb82-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-64"><a href="#cb82-64" aria-hidden="true" tabindex="-1"></a>Exploring these and other questions can provide valuable insights into the health status of different populations and can inform public health policies and interventions aimed at improving health outcomes.</span>
<span id="cb82-65"><a href="#cb82-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-66"><a href="#cb82-66" aria-hidden="true" tabindex="-1"></a><span class="fu"># Mind Your Metals: Exploring the Impact of Heavy Metals on Depression with Machine Learning</span></span>
<span id="cb82-67"><a href="#cb82-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-68"><a href="#cb82-68" aria-hidden="true" tabindex="-1"></a>The association between heavy metals and depression has been a topic of interest in scientific research. Studies have investigated the potential relationship between exposure to heavy metals and the development or exacerbation of depressive symptoms. Here are some general observations from the existing literature:</span>
<span id="cb82-69"><a href="#cb82-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-70"><a href="#cb82-70" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Lead**: Exposure to lead has been associated with an increased risk of depressive symptoms. Lead is a neurotoxic metal that can affect the central nervous system and disrupt neurotransmitter function, potentially contributing to depressive symptoms.</span>
<span id="cb82-71"><a href="#cb82-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-72"><a href="#cb82-72" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Mercury**: Some studies suggest a possible link between mercury exposure and depression. Mercury is a toxic metal that can accumulate in the body, including the brain. It may have adverse effects on mood regulation and neurotransmitter function, potentially contributing to depressive symptoms.</span>
<span id="cb82-73"><a href="#cb82-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-74"><a href="#cb82-74" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Cadmium**: Cadmium exposure has been associated with an increased risk of depression in some studies. Cadmium is a toxic metal found in industrial pollutants and tobacco smoke. It may disrupt neuroendocrine function and contribute to the development of depressive symptoms.</span>
<span id="cb82-75"><a href="#cb82-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-76"><a href="#cb82-76" aria-hidden="true" tabindex="-1"></a><span class="fu">## Machine Learning within Studies of Early-life Environmental Exposures and Child Health: Review of the current literature and discussion of next-steps</span></span>
<span id="cb82-77"><a href="#cb82-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-78"><a href="#cb82-78" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Oskar and Stingone</span><span class="co">](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7483339/)</span> emphasize that while ML methods have been widely used for prediction and classification in other fields, environmental health research has traditionally focused on causal or explanatory modeling. However, with the availability of complex environmental health data and the interest in holistic exposure paradigms such as the exposome, there is a need for analytic methods that can address the unique challenges posed by high-dimensional environmental health data.</span>
<span id="cb82-79"><a href="#cb82-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-80"><a href="#cb82-80" aria-hidden="true" tabindex="-1"></a>Their article explores how researchers have applied ML methods in studies of environmental exposures and childrens' health. It identifies common themes in these studies, including the analysis of environmental mixtures, exposure prediction and characterization, disease prediction and forecasting, analysis of other complex data, and improvements to causal inference. The review summarizes the strengths and limitations of implementing ML methods in these areas and identifies gaps in the literature.</span>
<span id="cb82-81"><a href="#cb82-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-82"><a href="#cb82-82" aria-hidden="true" tabindex="-1"></a><span class="fu">## Machine learning model for depression based on heavy metals among aging people: A study with National Health and Nutrition Examination Survey 2017--2018</span></span>
<span id="cb82-83"><a href="#cb82-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-84"><a href="#cb82-84" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Xia et al.</span><span class="co">](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC9386350/)</span> aimed to explore the association between depression and blood metal elements using a machine learning model. The study utilized data from the National Health and Nutrition Examination Survey (NHANES) conducted in 2017-2018. A total of 3,247 aging samples were included, and 10 different metals were analyzed, including lead (Pb), mercury (Hg), cadmium (Cd), manganese (Mn), selenium (Se), chromium (Cr), cobalt (Co), inorganic mercury (InHg), methylmercury (MeHg), and ethyl mercury (EtHg).</span>
<span id="cb82-85"><a href="#cb82-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-86"><a href="#cb82-86" aria-hidden="true" tabindex="-1"></a>The study compared eight machine learning algorithms for analyzing the association between metal elements and depression. Among the algorithms tested, XGBoost showed optimal effects and was used for further analysis. The study employed both Poisson regression and the XGBoost model to identify risk factors and predict depression.</span>
<span id="cb82-87"><a href="#cb82-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-88"><a href="#cb82-88" aria-hidden="true" tabindex="-1"></a>The results revealed that out of the 3,247 participants, 344 individuals were diagnosed with depression. In the Poisson regression model, the metals Cd (Î² = 0.22, P = 0.00000941), EtHg (Î² = 3.43, P = 0.003216), and Hg (Î² = -0.15, P = 0.001524) were found to be significantly related to depression. The XGBoost model demonstrated good performance for evaluating depression, with an accuracy of 0.89 (95%CI: 0.87, 0.92), a Kappa value of 0.006, and an area under the curve (AUC) of 0.88. An online XGBoost application for depression prediction was also developed.</span>
<span id="cb82-89"><a href="#cb82-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-90"><a href="#cb82-90" aria-hidden="true" tabindex="-1"></a>The study concluded that blood heavy metals, particularly Cd, EtHg, and Hg, were significantly associated with depression. The prediction of depression using machine learning models was deemed essential.</span>
<span id="cb82-91"><a href="#cb82-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-92"><a href="#cb82-92" aria-hidden="true" tabindex="-1"></a><span class="fu">## Association of urinary heavy metals co-exposure and adult depression: Modification of physical activity</span></span>
<span id="cb82-93"><a href="#cb82-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-94"><a href="#cb82-94" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Fu et al.</span><span class="co">](https://www.sciencedirect.com/science/article/abs/pii/S0161813X23000165)</span> aimed to investigate the association between exposure to a mixture of urinary heavy metals and depression, as well as the potential moderating role of physical activity in this relationship. The study used data from the National Health and Nutrition Examination Survey (NHANES) conducted between 2011 and 2016. Depression was assessed using the Patient Health Questionnaire. Elastic net regression was used to select six heavy metals (cadmium, cobalt, tin, antimony, thallium, and mercury) for further analysis. Binomial logistic regression, generalized additive models, environment risk score (ERS), and weighted quantile sum (WQS) regression were employed to examine the effects of individual and cumulative exposure to these metals on depression risk. The study included 4,212 participants, and the prevalence of depression was 7.40%.</span>
<span id="cb82-95"><a href="#cb82-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-96"><a href="#cb82-96" aria-hidden="true" tabindex="-1"></a>The findings of the study indicated that urinary tin and antimony exposure were independently associated with an increased risk of depression. A linear dose-response relationship between tin exposure and depression risk was also observed. Moreover, cumulative exposure to multiple heavy metals was positively associated with depression risk, with tin, antimony, and cadmium identified as the metals contributing most to the overall mixture effect. Notably, the significant positive association between heavy metal mixture exposure and depression risk was observed primarily in individuals who were inactive in physical activity.</span>
<span id="cb82-97"><a href="#cb82-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-98"><a href="#cb82-98" aria-hidden="true" tabindex="-1"></a>In conclusion, this study demonstrated that combined exposure to urinary heavy metals was associated with an increased risk of depression. However, the detrimental effects of heavy metal exposure on depression risk appeared to be attenuated by engaging in physical activity. These findings have important implications for public health, highlighting the potential role of both heavy metal exposure and physical activity in the development and prevention of depression.</span>
<span id="cb82-99"><a href="#cb82-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-100"><a href="#cb82-100" aria-hidden="true" tabindex="-1"></a><span class="fu"># **Research Question:**</span></span>
<span id="cb82-101"><a href="#cb82-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-102"><a href="#cb82-102" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*Mind Your Metals* aims to predict how factors such as age, gender, and heavy metals(lead, cadmium, and mercury etc.) can have an affect on one's mental health, specifically depression. We will examine this topic as a classification problem.</span>
<span id="cb82-103"><a href="#cb82-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-104"><a href="#cb82-104" aria-hidden="true" tabindex="-1"></a>From the *National Health and Nutrition Examination Survey* we chose to examine:</span>
<span id="cb82-105"><a href="#cb82-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-106"><a href="#cb82-106" aria-hidden="true" tabindex="-1"></a><span class="fu">## [**Independent Variable(s):**]{.underline}</span></span>
<span id="cb82-107"><a href="#cb82-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-108"><a href="#cb82-108" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**DS1: Demographics**</span>
<span id="cb82-109"><a href="#cb82-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-110"><a href="#cb82-110" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Age</span>
<span id="cb82-111"><a href="#cb82-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-112"><a href="#cb82-112" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Gender</span>
<span id="cb82-113"><a href="#cb82-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-114"><a href="#cb82-114" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**DS102: Blood Lead and Blood Cadmium**</span>
<span id="cb82-115"><a href="#cb82-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-116"><a href="#cb82-116" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Lead</span>
<span id="cb82-117"><a href="#cb82-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-118"><a href="#cb82-118" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Cadmium</span>
<span id="cb82-119"><a href="#cb82-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-120"><a href="#cb82-120" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**DS130: Blood Total Mercury and Blood Total Inorganic Mercury**</span>
<span id="cb82-121"><a href="#cb82-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-122"><a href="#cb82-122" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Mercury</span>
<span id="cb82-123"><a href="#cb82-123" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Inorganic Mercury</span>
<span id="cb82-124"><a href="#cb82-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-125"><a href="#cb82-125" aria-hidden="true" tabindex="-1"></a><span class="fu">## [**Dependent Variable**]{.underline}</span></span>
<span id="cb82-126"><a href="#cb82-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-127"><a href="#cb82-127" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**DS209: Depression Screener**</span>
<span id="cb82-128"><a href="#cb82-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-129"><a href="#cb82-129" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Feeling down, depressed, or hopeless</span>
<span id="cb82-130"><a href="#cb82-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-131"><a href="#cb82-131" aria-hidden="true" tabindex="-1"></a><span class="fu"># Exploratory Data Analysis</span></span>
<span id="cb82-132"><a href="#cb82-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-133"><a href="#cb82-133" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tidying Data</span></span>
<span id="cb82-134"><a href="#cb82-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-135"><a href="#cb82-135" aria-hidden="true" tabindex="-1"></a><span class="fu">### **DS1: Demographics**</span></span>
<span id="cb82-136"><a href="#cb82-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-137"><a href="#cb82-137" aria-hidden="true" tabindex="-1"></a><span class="in">```{r demographic}</span></span>
<span id="cb82-138"><a href="#cb82-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-139"><a href="#cb82-139" aria-hidden="true" tabindex="-1"></a><span class="co"># demographic data</span></span>
<span id="cb82-140"><a href="#cb82-140" aria-hidden="true" tabindex="-1"></a>demographic <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(<span class="st">"sleep/DS0001/25504-0001-Data.dta"</span>)</span>
<span id="cb82-141"><a href="#cb82-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-142"><a href="#cb82-142" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(demographic)</span>
<span id="cb82-143"><a href="#cb82-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-144"><a href="#cb82-144" aria-hidden="true" tabindex="-1"></a>demographic_select <span class="ot">&lt;-</span> demographic<span class="sc">%&gt;%</span></span>
<span id="cb82-145"><a href="#cb82-145" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(SEQN, RIAGENDR, RIDAGEYR)<span class="sc">%&gt;%</span></span>
<span id="cb82-146"><a href="#cb82-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">GENDER =</span> RIAGENDR,</span>
<span id="cb82-147"><a href="#cb82-147" aria-hidden="true" tabindex="-1"></a>         <span class="at">AGE =</span> RIDAGEYR)</span>
<span id="cb82-148"><a href="#cb82-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-149"><a href="#cb82-149" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-150"><a href="#cb82-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-151"><a href="#cb82-151" aria-hidden="true" tabindex="-1"></a><span class="fu">### DS102: Blood Lead and Blood Cadmium</span></span>
<span id="cb82-152"><a href="#cb82-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-153"><a href="#cb82-153" aria-hidden="true" tabindex="-1"></a><span class="in">```{r blood lead and cadmium}</span></span>
<span id="cb82-154"><a href="#cb82-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-155"><a href="#cb82-155" aria-hidden="true" tabindex="-1"></a>blood_PBCD <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(<span class="st">"sleep/DS0102/25504-0102-Data.dta"</span>)</span>
<span id="cb82-156"><a href="#cb82-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-157"><a href="#cb82-157" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(blood_PBCD)</span>
<span id="cb82-158"><a href="#cb82-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-159"><a href="#cb82-159" aria-hidden="true" tabindex="-1"></a>blood_PBCD_select <span class="ot">&lt;-</span> blood_PBCD<span class="sc">%&gt;%</span></span>
<span id="cb82-160"><a href="#cb82-160" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(SEQN, LBXBPB, LBXBCD)<span class="sc">%&gt;%</span></span>
<span id="cb82-161"><a href="#cb82-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">LEAD_UGDL =</span> LBXBPB,</span>
<span id="cb82-162"><a href="#cb82-162" aria-hidden="true" tabindex="-1"></a>         <span class="at">CADMIUM_UGL =</span> LBXBCD)</span>
<span id="cb82-163"><a href="#cb82-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-164"><a href="#cb82-164" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-165"><a href="#cb82-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-166"><a href="#cb82-166" aria-hidden="true" tabindex="-1"></a><span class="fu">### DS130: Blood Total Mercury and Blood Inorganic Mercury</span></span>
<span id="cb82-167"><a href="#cb82-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-168"><a href="#cb82-168" aria-hidden="true" tabindex="-1"></a><span class="in">```{r blood mercury and inorganic mercury}</span></span>
<span id="cb82-169"><a href="#cb82-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-170"><a href="#cb82-170" aria-hidden="true" tabindex="-1"></a>blood_HGIHG <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(<span class="st">"sleep/DS0130/25504-0130-Data.dta"</span>)</span>
<span id="cb82-171"><a href="#cb82-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-172"><a href="#cb82-172" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(blood_HGIHG)</span>
<span id="cb82-173"><a href="#cb82-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-174"><a href="#cb82-174" aria-hidden="true" tabindex="-1"></a>blood_HGIHG_select <span class="ot">&lt;-</span> blood_HGIHG<span class="sc">%&gt;%</span></span>
<span id="cb82-175"><a href="#cb82-175" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(SEQN, LBXTHG, LBXIHG)<span class="sc">%&gt;%</span></span>
<span id="cb82-176"><a href="#cb82-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">MERCURY_UGL =</span> LBXTHG,</span>
<span id="cb82-177"><a href="#cb82-177" aria-hidden="true" tabindex="-1"></a>         <span class="at">INORG_MERCURY_UGL =</span> LBXIHG)</span>
<span id="cb82-178"><a href="#cb82-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-179"><a href="#cb82-179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-180"><a href="#cb82-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-181"><a href="#cb82-181" aria-hidden="true" tabindex="-1"></a><span class="fu">### DS209: Depression Screener</span></span>
<span id="cb82-182"><a href="#cb82-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-183"><a href="#cb82-183" aria-hidden="true" tabindex="-1"></a><span class="in">```{r depression}</span></span>
<span id="cb82-184"><a href="#cb82-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-185"><a href="#cb82-185" aria-hidden="true" tabindex="-1"></a>depression <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(<span class="st">"sleep/DS0209/25504-0209-Data.dta"</span>)</span>
<span id="cb82-186"><a href="#cb82-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-187"><a href="#cb82-187" aria-hidden="true" tabindex="-1"></a>unwanted_categories <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Don't know"</span>, <span class="st">"Refused"</span>)</span>
<span id="cb82-188"><a href="#cb82-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-189"><a href="#cb82-189" aria-hidden="true" tabindex="-1"></a>depression_select <span class="ot">&lt;-</span> depression<span class="sc">%&gt;%</span></span>
<span id="cb82-190"><a href="#cb82-190" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(SEQN, DPQ020)<span class="sc">%&gt;%</span></span>
<span id="cb82-191"><a href="#cb82-191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">DEPRESSED =</span> DPQ020)<span class="sc">%&gt;%</span></span>
<span id="cb82-192"><a href="#cb82-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(DEPRESSED <span class="sc">%in%</span> unwanted_categories))<span class="sc">%&gt;%</span></span>
<span id="cb82-193"><a href="#cb82-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(DEPRESSED))</span>
<span id="cb82-194"><a href="#cb82-194" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb82-195"><a href="#cb82-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-196"><a href="#cb82-196" aria-hidden="true" tabindex="-1"></a>depression_select<span class="sc">$</span>DEPRESSED<span class="ot">&lt;-</span><span class="fu">droplevels</span>(depression_select<span class="sc">$</span>DEPRESSED)</span>
<span id="cb82-197"><a href="#cb82-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-198"><a href="#cb82-198" aria-hidden="true" tabindex="-1"></a>depression_select <span class="ot">&lt;-</span> depression_select<span class="sc">%&gt;%</span></span>
<span id="cb82-199"><a href="#cb82-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DEPRESSED =</span> <span class="fu">case_when</span>(</span>
<span id="cb82-200"><a href="#cb82-200" aria-hidden="true" tabindex="-1"></a>    DEPRESSED <span class="sc">==</span> <span class="st">"Not at all"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb82-201"><a href="#cb82-201" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">1</span></span>
<span id="cb82-202"><a href="#cb82-202" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb82-203"><a href="#cb82-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-204"><a href="#cb82-204" aria-hidden="true" tabindex="-1"></a>depression_select<span class="sc">$</span>DEPRESSED <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(depression_select<span class="sc">$</span>DEPRESSED)</span>
<span id="cb82-205"><a href="#cb82-205" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-206"><a href="#cb82-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-207"><a href="#cb82-207" aria-hidden="true" tabindex="-1"></a><span class="fu">## Join Data Frames</span></span>
<span id="cb82-208"><a href="#cb82-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-209"><a href="#cb82-209" aria-hidden="true" tabindex="-1"></a><span class="in">```{r data frame select}</span></span>
<span id="cb82-210"><a href="#cb82-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-211"><a href="#cb82-211" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(demographic_select)</span>
<span id="cb82-212"><a href="#cb82-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-213"><a href="#cb82-213" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(blood_PBCD_select)</span>
<span id="cb82-214"><a href="#cb82-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-215"><a href="#cb82-215" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(blood_HGIHG_select)</span>
<span id="cb82-216"><a href="#cb82-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-217"><a href="#cb82-217" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(depression_select)</span>
<span id="cb82-218"><a href="#cb82-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-219"><a href="#cb82-219" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-220"><a href="#cb82-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-221"><a href="#cb82-221" aria-hidden="true" tabindex="-1"></a><span class="in">```{r join data}</span></span>
<span id="cb82-222"><a href="#cb82-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-223"><a href="#cb82-223" aria-hidden="true" tabindex="-1"></a><span class="co"># merging demographic and blood lead and blood cadmium</span></span>
<span id="cb82-224"><a href="#cb82-224" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> demographic_select <span class="sc">%&gt;%</span> <span class="fu">inner_join</span>(blood_PBCD_select, <span class="at">by =</span> <span class="fu">join_by</span>(SEQN))</span>
<span id="cb82-225"><a href="#cb82-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-226"><a href="#cb82-226" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(a)</span>
<span id="cb82-227"><a href="#cb82-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-228"><a href="#cb82-228" aria-hidden="true" tabindex="-1"></a><span class="co"># merging demographic and blood lead and blood cadmium and blood total mercury and blood inorganic mercury </span></span>
<span id="cb82-229"><a href="#cb82-229" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> a <span class="sc">%&gt;%</span> <span class="fu">inner_join</span>(blood_HGIHG_select, <span class="at">by =</span> <span class="fu">join_by</span>(SEQN))</span>
<span id="cb82-230"><a href="#cb82-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-231"><a href="#cb82-231" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(b)</span>
<span id="cb82-232"><a href="#cb82-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-233"><a href="#cb82-233" aria-hidden="true" tabindex="-1"></a><span class="co"># merging demographic and blood lead and blood cadmium and blood total mercury and blood inorganic mercury and depression screener</span></span>
<span id="cb82-234"><a href="#cb82-234" aria-hidden="true" tabindex="-1"></a>final_select <span class="ot">&lt;-</span> b <span class="sc">%&gt;%</span> <span class="fu">inner_join</span>(depression_select, <span class="at">by =</span> <span class="fu">join_by</span>(SEQN))</span>
<span id="cb82-235"><a href="#cb82-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-236"><a href="#cb82-236" aria-hidden="true" tabindex="-1"></a><span class="co">#LEAD_UGDL has a measurement tag of UGDL to correspond with the original NHANES data.</span></span>
<span id="cb82-237"><a href="#cb82-237" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(final_select)</span>
<span id="cb82-238"><a href="#cb82-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-239"><a href="#cb82-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-240"><a href="#cb82-240" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-241"><a href="#cb82-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-242"><a href="#cb82-242" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exploring Relationships</span></span>
<span id="cb82-243"><a href="#cb82-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-244"><a href="#cb82-244" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary Statistics</span></span>
<span id="cb82-245"><a href="#cb82-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-246"><a href="#cb82-246" aria-hidden="true" tabindex="-1"></a><span class="in">```{r summary statistic}</span></span>
<span id="cb82-247"><a href="#cb82-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-248"><a href="#cb82-248" aria-hidden="true" tabindex="-1"></a><span class="co"># 4831 rows and 8 columns</span></span>
<span id="cb82-249"><a href="#cb82-249" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(final_select)</span>
<span id="cb82-250"><a href="#cb82-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-251"><a href="#cb82-251" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summarytools<span class="sc">::</span><span class="fu">dfSummary</span>(final_select,</span>
<span id="cb82-252"><a href="#cb82-252" aria-hidden="true" tabindex="-1"></a>                        <span class="at">varnumbers =</span> <span class="cn">FALSE</span>,</span>
<span id="cb82-253"><a href="#cb82-253" aria-hidden="true" tabindex="-1"></a>                        <span class="at">plain.ascii  =</span> <span class="cn">FALSE</span>,</span>
<span id="cb82-254"><a href="#cb82-254" aria-hidden="true" tabindex="-1"></a>                        <span class="at">style        =</span> <span class="st">"grid"</span>,</span>
<span id="cb82-255"><a href="#cb82-255" aria-hidden="true" tabindex="-1"></a>                        <span class="at">graph.magnif =</span> <span class="fl">0.70</span>,</span>
<span id="cb82-256"><a href="#cb82-256" aria-hidden="true" tabindex="-1"></a>                        <span class="at">valid.col    =</span> <span class="cn">FALSE</span>),</span>
<span id="cb82-257"><a href="#cb82-257" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">'render'</span>,</span>
<span id="cb82-258"><a href="#cb82-258" aria-hidden="true" tabindex="-1"></a>      <span class="at">table.classes =</span> <span class="st">'table-condensed'</span>)</span>
<span id="cb82-259"><a href="#cb82-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-260"><a href="#cb82-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-261"><a href="#cb82-261" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-262"><a href="#cb82-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-263"><a href="#cb82-263" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>LEAD_UGDL:</span>
<span id="cb82-264"><a href="#cb82-264" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Mean in group 0 (non-depressed): 1.816518</span>
<span id="cb82-265"><a href="#cb82-265" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Mean in group 1 (depressed): 1.811838</span>
<span id="cb82-266"><a href="#cb82-266" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>The difference in means between the two groups is not statistically significant (p-value = 0.9397). The 95% confidence interval for the difference spans from -0.1166816 to 0.1260427.</span>
<span id="cb82-267"><a href="#cb82-267" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>CADMIUM_UGL:</span>
<span id="cb82-268"><a href="#cb82-268" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Mean in group 0 (non-depressed): 0.4885205</span>
<span id="cb82-269"><a href="#cb82-269" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Mean in group 1 (depressed): 0.5977713</span>
<span id="cb82-270"><a href="#cb82-270" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>The difference in means between the two groups is statistically significant (p-value = 1.464e-06). The 95% confidence interval for the difference ranges from -0.15357010 to -0.06493149.</span>
<span id="cb82-271"><a href="#cb82-271" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>MERCURY_UGL:</span>
<span id="cb82-272"><a href="#cb82-272" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Mean in group 0 (non-depressed): 1.496233</span>
<span id="cb82-273"><a href="#cb82-273" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Mean in group 1 (depressed): 1.228055</span>
<span id="cb82-274"><a href="#cb82-274" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>The difference in means between the two groups is statistically significant (p-value = 2.567e-06). The 95% confidence interval for the difference is between 0.1566488 and 0.3797086.</span>
<span id="cb82-275"><a href="#cb82-275" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>INORG_MERCURY_UGL:</span>
<span id="cb82-276"><a href="#cb82-276" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Mean in group 0 (non-depressed): 0.3450734</span>
<span id="cb82-277"><a href="#cb82-277" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Mean in group 1 (depressed): 0.3349219</span>
<span id="cb82-278"><a href="#cb82-278" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>The difference in means between the two groups is not statistically significant (p-value = 0.2626). The 95% confidence interval for the difference spans from -0.007614401 to 0.027917506.</span>
<span id="cb82-279"><a href="#cb82-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-280"><a href="#cb82-280" aria-hidden="true" tabindex="-1"></a>These results suggest that there are statistically significant differences in the mean levels of CADMIUM_UGL and MERCURY_UGL between depressed and non-depressed groups. However, there are no significant differences in the mean levels of LEAD_UGDL and INORG_MERCURY_UGL between the two groups.</span>
<span id="cb82-281"><a href="#cb82-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-282"><a href="#cb82-282" aria-hidden="true" tabindex="-1"></a><span class="in">```{r welch two sample t-test}</span></span>
<span id="cb82-283"><a href="#cb82-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-284"><a href="#cb82-284" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(LEAD_UGDL <span class="sc">~</span> DEPRESSED, <span class="at">data =</span> final_select)</span>
<span id="cb82-285"><a href="#cb82-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-286"><a href="#cb82-286" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(CADMIUM_UGL <span class="sc">~</span> DEPRESSED, <span class="at">data =</span> final_select)</span>
<span id="cb82-287"><a href="#cb82-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-288"><a href="#cb82-288" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(MERCURY_UGL <span class="sc">~</span> DEPRESSED, <span class="at">data =</span> final_select)</span>
<span id="cb82-289"><a href="#cb82-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-290"><a href="#cb82-290" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(INORG_MERCURY_UGL <span class="sc">~</span> DEPRESSED, <span class="at">data =</span> final_select)</span>
<span id="cb82-291"><a href="#cb82-291" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-292"><a href="#cb82-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-293"><a href="#cb82-293" aria-hidden="true" tabindex="-1"></a><span class="fu">## Heavy Metal Average: Between Male &amp; Female</span></span>
<span id="cb82-294"><a href="#cb82-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-297"><a href="#cb82-297" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-298"><a href="#cb82-298" aria-hidden="true" tabindex="-1"></a><span class="co">#finding the average of heavy metals in males and females </span></span>
<span id="cb82-299"><a href="#cb82-299" aria-hidden="true" tabindex="-1"></a>avg_metal <span class="ot">&lt;-</span> final_select<span class="sc">%&gt;%</span></span>
<span id="cb82-300"><a href="#cb82-300" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(GENDER, DEPRESSED, CADMIUM_UGL, MERCURY_UGL)<span class="sc">%&gt;%</span></span>
<span id="cb82-301"><a href="#cb82-301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(GENDER)<span class="sc">%&gt;%</span></span>
<span id="cb82-302"><a href="#cb82-302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(DEPRESSED <span class="sc">==</span> <span class="dv">1</span>)<span class="sc">%&gt;%</span></span>
<span id="cb82-303"><a href="#cb82-303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">CADMIUM_MEAN =</span> <span class="fu">mean</span>(CADMIUM_UGL, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb82-304"><a href="#cb82-304" aria-hidden="true" tabindex="-1"></a>            <span class="at">MERCURY_MEAN =</span> <span class="fu">mean</span>(MERCURY_UGL, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb82-305"><a href="#cb82-305" aria-hidden="true" tabindex="-1"></a>avg_metal</span>
<span id="cb82-306"><a href="#cb82-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-307"><a href="#cb82-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-308"><a href="#cb82-308" aria-hidden="true" tabindex="-1"></a>avg_metal_pivot <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(avg_metal, CADMIUM_MEAN<span class="sc">:</span>MERCURY_MEAN, <span class="at">names_to =</span> <span class="st">"MEAN"</span>, <span class="at">values_to =</span> <span class="st">"UGL"</span>)</span>
<span id="cb82-309"><a href="#cb82-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-310"><a href="#cb82-310" aria-hidden="true" tabindex="-1"></a>avg_metal_pivot</span>
<span id="cb82-311"><a href="#cb82-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-312"><a href="#cb82-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-313"><a href="#cb82-313" aria-hidden="true" tabindex="-1"></a>mf_avg_metal <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> avg_metal_pivot) <span class="sc">+</span></span>
<span id="cb82-314"><a href="#cb82-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">MEAN</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">UGL</span><span class="st">`</span>, <span class="at">fill =</span> <span class="st">`</span><span class="at">MEAN</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb82-315"><a href="#cb82-315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">25</span>,<span class="at">hjust=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb82-316"><a href="#cb82-316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>GENDER)<span class="sc">+</span></span>
<span id="cb82-317"><a href="#cb82-317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb82-318"><a href="#cb82-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-319"><a href="#cb82-319" aria-hidden="true" tabindex="-1"></a>mf_avg_metal</span>
<span id="cb82-320"><a href="#cb82-320" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb82-321"><a href="#cb82-321" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-322"><a href="#cb82-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-323"><a href="#cb82-323" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data Split: Train(80%) and Test(20%)</span></span>
<span id="cb82-324"><a href="#cb82-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-325"><a href="#cb82-325" aria-hidden="true" tabindex="-1"></a><span class="in">```{r split to train and test}</span></span>
<span id="cb82-326"><a href="#cb82-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-327"><a href="#cb82-327" aria-hidden="true" tabindex="-1"></a>final_select <span class="ot">&lt;-</span> final_select<span class="sc">%&gt;%</span></span>
<span id="cb82-328"><a href="#cb82-328" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(SEQN, AGE, GENDER, DEPRESSED, CADMIUM_UGL, MERCURY_UGL)</span>
<span id="cb82-329"><a href="#cb82-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-330"><a href="#cb82-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-331"><a href="#cb82-331" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb82-332"><a href="#cb82-332" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> final_select <span class="sc">%&gt;%</span>dplyr<span class="sc">::</span><span class="fu">sample_frac</span>(<span class="fl">0.8</span>)</span>
<span id="cb82-333"><a href="#cb82-333" aria-hidden="true" tabindex="-1"></a>test  <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">anti_join</span>(final_select, train, <span class="at">by =</span> <span class="st">"SEQN"</span>)</span>
<span id="cb82-334"><a href="#cb82-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-335"><a href="#cb82-335" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(train)</span>
<span id="cb82-336"><a href="#cb82-336" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-337"><a href="#cb82-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-338"><a href="#cb82-338" aria-hidden="true" tabindex="-1"></a><span class="fu"># Training Data</span></span>
<span id="cb82-339"><a href="#cb82-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-340"><a href="#cb82-340" aria-hidden="true" tabindex="-1"></a>We decided to impute the missing values with median as the MAX data points were far from the majority of data points based on the quantiles.</span>
<span id="cb82-341"><a href="#cb82-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-342"><a href="#cb82-342" aria-hidden="true" tabindex="-1"></a><span class="in">```{r train}</span></span>
<span id="cb82-343"><a href="#cb82-343" aria-hidden="true" tabindex="-1"></a><span class="co">#decide to use Median over mean, as the 'Max.' are very far from spread</span></span>
<span id="cb82-344"><a href="#cb82-344" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(train)</span>
<span id="cb82-345"><a href="#cb82-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-346"><a href="#cb82-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-347"><a href="#cb82-347" aria-hidden="true" tabindex="-1"></a>train<span class="ot">&lt;-</span>train <span class="sc">%&gt;%</span></span>
<span id="cb82-348"><a href="#cb82-348" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">CADMIUM_UGL =</span> <span class="fu">median</span>(train<span class="sc">$</span>CADMIUM_UGL,<span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb82-349"><a href="#cb82-349" aria-hidden="true" tabindex="-1"></a>                         <span class="at">MERCURY_UGL =</span> <span class="fu">median</span>(train<span class="sc">$</span>MERCURY_UGL,<span class="at">na.rm=</span><span class="cn">TRUE</span>)))</span>
<span id="cb82-350"><a href="#cb82-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-351"><a href="#cb82-351" aria-hidden="true" tabindex="-1"></a><span class="co">#validation that NA are replaced by median </span></span>
<span id="cb82-352"><a href="#cb82-352" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(train))</span>
<span id="cb82-353"><a href="#cb82-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-354"><a href="#cb82-354" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-355"><a href="#cb82-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-356"><a href="#cb82-356" aria-hidden="true" tabindex="-1"></a><span class="fu"># Evaluation Metric</span></span>
<span id="cb82-357"><a href="#cb82-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-358"><a href="#cb82-358" aria-hidden="true" tabindex="-1"></a>F1 score is a commonly used and effective evaluation metric for classification problems, especially when the dataset is imbalanced.</span>
<span id="cb82-359"><a href="#cb82-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-360"><a href="#cb82-360" aria-hidden="true" tabindex="-1"></a>Our dataset presented an imbalance between the depressed and non-depressed individuals.</span>
<span id="cb82-361"><a href="#cb82-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-362"><a href="#cb82-362" aria-hidden="true" tabindex="-1"></a><span class="fu">## KNN</span></span>
<span id="cb82-363"><a href="#cb82-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-364"><a href="#cb82-364" aria-hidden="true" tabindex="-1"></a>We tested for different values of k in k-nearest neighbors (KNN) models; k = 1 - 10.</span>
<span id="cb82-365"><a href="#cb82-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-366"><a href="#cb82-366" aria-hidden="true" tabindex="-1"></a>k = 1 gave the best F1 score of 0.9904793</span>
<span id="cb82-367"><a href="#cb82-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-368"><a href="#cb82-368" aria-hidden="true" tabindex="-1"></a><span class="in">```{r KNN}</span></span>
<span id="cb82-369"><a href="#cb82-369" aria-hidden="true" tabindex="-1"></a>train<span class="ot">&lt;-</span>train<span class="sc">%&gt;%</span></span>
<span id="cb82-370"><a href="#cb82-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(GENDER,DEPRESSED,<span class="at">.before=</span>SEQN)</span>
<span id="cb82-371"><a href="#cb82-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-372"><a href="#cb82-372" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb82-373"><a href="#cb82-373" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">5</span>)</span>
<span id="cb82-374"><a href="#cb82-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-375"><a href="#cb82-375" aria-hidden="true" tabindex="-1"></a><span class="co">#scale the data</span></span>
<span id="cb82-376"><a href="#cb82-376" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> train<span class="sc">%&gt;%</span></span>
<span id="cb82-377"><a href="#cb82-377" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>( AGE<span class="sc">:</span>MERCURY_UGL)</span>
<span id="cb82-378"><a href="#cb82-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-379"><a href="#cb82-379" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span>train<span class="sc">%&gt;%</span></span>
<span id="cb82-380"><a href="#cb82-380" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(GENDER, DEPRESSED)</span>
<span id="cb82-381"><a href="#cb82-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-382"><a href="#cb82-382" aria-hidden="true" tabindex="-1"></a>x_scaled<span class="ot">&lt;-</span><span class="fu">scale</span>(x, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb82-383"><a href="#cb82-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-384"><a href="#cb82-384" aria-hidden="true" tabindex="-1"></a>x_scaled<span class="ot">&lt;-</span><span class="fu">cbind</span>(y,x_scaled)</span>
<span id="cb82-385"><a href="#cb82-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-386"><a href="#cb82-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-387"><a href="#cb82-387" aria-hidden="true" tabindex="-1"></a>k_list <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">10</span>))</span>
<span id="cb82-388"><a href="#cb82-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-389"><a href="#cb82-389" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(k_list) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'K'</span>,<span class="st">'F1'</span>)</span>
<span id="cb82-390"><a href="#cb82-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-391"><a href="#cb82-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-392"><a href="#cb82-392" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb82-393"><a href="#cb82-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-394"><a href="#cb82-394" aria-hidden="true" tabindex="-1"></a>KNN1 <span class="ot">&lt;-</span> <span class="fu">train</span>(DEPRESSED<span class="sc">~</span>., <span class="at">data =</span> x_scaled, <span class="at">tuneGrid=</span><span class="fu">data.frame</span>(<span class="at">k=</span>i),<span class="at">method =</span> <span class="st">"knn"</span>, <span class="at">trControl=</span>ctrl, <span class="at">tuneLength =</span> <span class="dv">0</span>)</span>
<span id="cb82-395"><a href="#cb82-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-396"><a href="#cb82-396" aria-hidden="true" tabindex="-1"></a>KNN1.pred<span class="ot">&lt;-</span><span class="fu">predict</span>(KNN1,x_scaled)</span>
<span id="cb82-397"><a href="#cb82-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-398"><a href="#cb82-398" aria-hidden="true" tabindex="-1"></a>cm_KNN1<span class="ot">&lt;-</span><span class="fu">confusionMatrix</span>(KNN1.pred,x_scaled<span class="sc">$</span>DEPRESSED,<span class="at">mode=</span><span class="st">"prec_recall"</span>)</span>
<span id="cb82-399"><a href="#cb82-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-400"><a href="#cb82-400" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> cm_KNN1<span class="sc">$</span>byClass[<span class="st">"F1"</span>]</span>
<span id="cb82-401"><a href="#cb82-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-402"><a href="#cb82-402" aria-hidden="true" tabindex="-1"></a>k_list[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> i</span>
<span id="cb82-403"><a href="#cb82-403" aria-hidden="true" tabindex="-1"></a>k_list[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> f1</span>
<span id="cb82-404"><a href="#cb82-404" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb82-405"><a href="#cb82-405" aria-hidden="true" tabindex="-1"></a>k_list</span>
<span id="cb82-406"><a href="#cb82-406" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-407"><a href="#cb82-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-408"><a href="#cb82-408" aria-hidden="true" tabindex="-1"></a><span class="fu">## Random Forest</span></span>
<span id="cb82-409"><a href="#cb82-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-410"><a href="#cb82-410" aria-hidden="true" tabindex="-1"></a>We observed:</span>
<span id="cb82-411"><a href="#cb82-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-412"><a href="#cb82-412" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>20 to 100 trees with an increment of 20 in our random forest model</span>
<span id="cb82-413"><a href="#cb82-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-414"><a href="#cb82-414" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>6 different hyper-parameter control values 1 -6</span>
<span id="cb82-415"><a href="#cb82-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-416"><a href="#cb82-416" aria-hidden="true" tabindex="-1"></a>Regardless of the number of trees, the best F1 score was obtained through the hyper-parameter value of 1.</span>
<span id="cb82-417"><a href="#cb82-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-418"><a href="#cb82-418" aria-hidden="true" tabindex="-1"></a><span class="in">```{r random forest}</span></span>
<span id="cb82-419"><a href="#cb82-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-420"><a href="#cb82-420" aria-hidden="true" tabindex="-1"></a><span class="co"># set the seed for reproducibility</span></span>
<span id="cb82-421"><a href="#cb82-421" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb82-422"><a href="#cb82-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-423"><a href="#cb82-423" aria-hidden="true" tabindex="-1"></a><span class="co"># define the number of folds for cross-validation</span></span>
<span id="cb82-424"><a href="#cb82-424" aria-hidden="true" tabindex="-1"></a>num_folds <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb82-425"><a href="#cb82-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-426"><a href="#cb82-426" aria-hidden="true" tabindex="-1"></a><span class="co"># define hyperparameters to optimize</span></span>
<span id="cb82-427"><a href="#cb82-427" aria-hidden="true" tabindex="-1"></a>ntree_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">20</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">20</span>)</span>
<span id="cb82-428"><a href="#cb82-428" aria-hidden="true" tabindex="-1"></a>mtry_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)</span>
<span id="cb82-429"><a href="#cb82-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-430"><a href="#cb82-430" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize variables for storing performance</span></span>
<span id="cb82-431"><a href="#cb82-431" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ntree =</span> <span class="fu">numeric</span>(),</span>
<span id="cb82-432"><a href="#cb82-432" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mtry =</span> <span class="fu">numeric</span>(),</span>
<span id="cb82-433"><a href="#cb82-433" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mean_f1 =</span> <span class="fu">numeric</span>(),</span>
<span id="cb82-434"><a href="#cb82-434" aria-hidden="true" tabindex="-1"></a>                      <span class="at">SD_f1 =</span> <span class="fu">numeric</span>()</span>
<span id="cb82-435"><a href="#cb82-435" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb82-436"><a href="#cb82-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-437"><a href="#cb82-437" aria-hidden="true" tabindex="-1"></a><span class="co"># loop over hyperparameters to find the best combination and store performance</span></span>
<span id="cb82-438"><a href="#cb82-438" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (ntree <span class="cf">in</span> ntree_values) {</span>
<span id="cb82-439"><a href="#cb82-439" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (mtry <span class="cf">in</span> mtry_values) {</span>
<span id="cb82-440"><a href="#cb82-440" aria-hidden="true" tabindex="-1"></a>    <span class="co"># initialize variable for storing performance across folds</span></span>
<span id="cb82-441"><a href="#cb82-441" aria-hidden="true" tabindex="-1"></a>    f1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_folds)</span>
<span id="cb82-442"><a href="#cb82-442" aria-hidden="true" tabindex="-1"></a>    <span class="co"># loop over folds for cross-validation</span></span>
<span id="cb82-443"><a href="#cb82-443" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (fold <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_folds) {</span>
<span id="cb82-444"><a href="#cb82-444" aria-hidden="true" tabindex="-1"></a>      <span class="co"># create training and validation sets for current fold</span></span>
<span id="cb82-445"><a href="#cb82-445" aria-hidden="true" tabindex="-1"></a>      validIndex <span class="ot">&lt;-</span> ((fold <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">nrow</span>(train) <span class="sc">/</span> num_folds) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(fold <span class="sc">*</span> (<span class="fu">nrow</span>(train) <span class="sc">/</span> num_folds))</span>
<span id="cb82-446"><a href="#cb82-446" aria-hidden="true" tabindex="-1"></a>      valid <span class="ot">&lt;-</span> train[validIndex, ]</span>
<span id="cb82-447"><a href="#cb82-447" aria-hidden="true" tabindex="-1"></a>      train_rf <span class="ot">&lt;-</span> train[<span class="sc">-</span>validIndex, ]</span>
<span id="cb82-448"><a href="#cb82-448" aria-hidden="true" tabindex="-1"></a>      <span class="co"># fit the random forest model with the current hyperparameters on the training set</span></span>
<span id="cb82-449"><a href="#cb82-449" aria-hidden="true" tabindex="-1"></a>      model <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(DEPRESSED <span class="sc">~</span> GENDER <span class="sc">+</span> AGE <span class="sc">+</span> CADMIUM_UGL <span class="sc">+</span> MERCURY_UGL,</span>
<span id="cb82-450"><a href="#cb82-450" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> train_rf, <span class="at">ntree =</span> ntree, <span class="at">mtry =</span> mtry)</span>
<span id="cb82-451"><a href="#cb82-451" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb82-452"><a href="#cb82-452" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Make predictions on test data</span></span>
<span id="cb82-453"><a href="#cb82-453" aria-hidden="true" tabindex="-1"></a>      predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> valid)</span>
<span id="cb82-454"><a href="#cb82-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-455"><a href="#cb82-455" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Create a confusion matrix</span></span>
<span id="cb82-456"><a href="#cb82-456" aria-hidden="true" tabindex="-1"></a>      confusion_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(predictions, <span class="at">reference =</span> valid<span class="sc">$</span>DEPRESSED)</span>
<span id="cb82-457"><a href="#cb82-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-458"><a href="#cb82-458" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Extract the confusion matrix metrics</span></span>
<span id="cb82-459"><a href="#cb82-459" aria-hidden="true" tabindex="-1"></a>      precision <span class="ot">&lt;-</span> confusion_matrix<span class="sc">$</span>byClass[<span class="st">"Pos Pred Value"</span>]</span>
<span id="cb82-460"><a href="#cb82-460" aria-hidden="true" tabindex="-1"></a>      recall <span class="ot">&lt;-</span> confusion_matrix<span class="sc">$</span>byClass[<span class="st">"Sensitivity"</span>]</span>
<span id="cb82-461"><a href="#cb82-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-462"><a href="#cb82-462" aria-hidden="true" tabindex="-1"></a>      f1[fold] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision <span class="sc">*</span> recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb82-463"><a href="#cb82-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-464"><a href="#cb82-464" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb82-465"><a href="#cb82-465" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate mean and standard deviation of RMSLE across folds</span></span>
<span id="cb82-466"><a href="#cb82-466" aria-hidden="true" tabindex="-1"></a>    mean_f1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(f1)</span>
<span id="cb82-467"><a href="#cb82-467" aria-hidden="true" tabindex="-1"></a>    SD_f1<span class="ot">&lt;-</span> <span class="fu">sd</span>(f1)</span>
<span id="cb82-468"><a href="#cb82-468" aria-hidden="true" tabindex="-1"></a>    <span class="co"># store the performance of the current combination of hyperparameters</span></span>
<span id="cb82-469"><a href="#cb82-469" aria-hidden="true" tabindex="-1"></a>    results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results, <span class="fu">data.frame</span>(<span class="at">ntree =</span> ntree, <span class="at">mtry =</span> mtry, <span class="at">mean_f1 =</span> mean_f1, <span class="at">SD_f1 =</span> SD_f1))</span>
<span id="cb82-470"><a href="#cb82-470" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">'Completed mtry = '</span>, mtry, <span class="st">'and ntree = '</span>, ntree))</span>
<span id="cb82-471"><a href="#cb82-471" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">Sys.time</span>())</span>
<span id="cb82-472"><a href="#cb82-472" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb82-473"><a href="#cb82-473" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb82-474"><a href="#cb82-474" aria-hidden="true" tabindex="-1"></a><span class="co"># print the optimal values of hyperparameters</span></span>
<span id="cb82-475"><a href="#cb82-475" aria-hidden="true" tabindex="-1"></a>best <span class="ot">&lt;-</span> results[<span class="fu">which.min</span>(results<span class="sc">$</span>mean_f1), ]</span>
<span id="cb82-476"><a href="#cb82-476" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal ntree value:"</span>, best<span class="sc">$</span>ntree, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb82-477"><a href="#cb82-477" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Optimal mtry value:"</span>, best<span class="sc">$</span>mtry, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb82-478"><a href="#cb82-478" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mean f1:"</span>, best<span class="sc">$</span>mean_f1, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb82-479"><a href="#cb82-479" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(results, <span class="fu">aes</span>(<span class="at">x =</span> mtry, <span class="at">y =</span> ntree, <span class="at">fill =</span> mean_f1)) <span class="sc">+</span></span>
<span id="cb82-480"><a href="#cb82-480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb82-481"><a href="#cb82-481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb82-482"><a href="#cb82-482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(mean_f1, <span class="dv">3</span>)), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">colour =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb82-483"><a href="#cb82-483" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"F1 for Random Forest with Varying ntree and mtry"</span>) <span class="sc">+</span></span>
<span id="cb82-484"><a href="#cb82-484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"mtry"</span>) <span class="sc">+</span></span>
<span id="cb82-485"><a href="#cb82-485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"ntree"</span>) <span class="sc">+</span></span>
<span id="cb82-486"><a href="#cb82-486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb82-487"><a href="#cb82-487" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb82-488"><a href="#cb82-488" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>))</span>
<span id="cb82-489"><a href="#cb82-489" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-490"><a href="#cb82-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-491"><a href="#cb82-491" aria-hidden="true" tabindex="-1"></a><span class="fu">## Support Vector Machine svmRadial</span></span>
<span id="cb82-492"><a href="#cb82-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-493"><a href="#cb82-493" aria-hidden="true" tabindex="-1"></a>We observed a sequence of values from 0.1 to 1 with an increment of 0.1 for the width of the RBF kernel. Additionally, we observed a sequence of values from 1 to 10 with an increment of 1 for the regularization parameter in our SVM.</span>
<span id="cb82-494"><a href="#cb82-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-495"><a href="#cb82-495" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Best Parameters: sigma = 0.8, C = 1</span>
<span id="cb82-496"><a href="#cb82-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-497"><a href="#cb82-497" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>F1 Score: 0.881435029896456</span>
<span id="cb82-498"><a href="#cb82-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-499"><a href="#cb82-499" aria-hidden="true" tabindex="-1"></a><span class="in">```{r svmRadial}</span></span>
<span id="cb82-500"><a href="#cb82-500" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb82-501"><a href="#cb82-501" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the parameter grid</span></span>
<span id="cb82-502"><a href="#cb82-502" aria-hidden="true" tabindex="-1"></a>parameter_grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">sigma =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>),</span>
<span id="cb82-503"><a href="#cb82-503" aria-hidden="true" tabindex="-1"></a>                              <span class="at">C =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span>))</span>
<span id="cb82-504"><a href="#cb82-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-505"><a href="#cb82-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-506"><a href="#cb82-506" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the SVM model with different parameter combinations</span></span>
<span id="cb82-507"><a href="#cb82-507" aria-hidden="true" tabindex="-1"></a>svm_model <span class="ot">&lt;-</span> <span class="fu">train</span>(DEPRESSED <span class="sc">~</span> GENDER <span class="sc">+</span> AGE <span class="sc">+</span> CADMIUM_UGL <span class="sc">+</span> MERCURY_UGL, </span>
<span id="cb82-508"><a href="#cb82-508" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, <span class="at">method =</span> <span class="st">"svmRadial"</span>,</span>
<span id="cb82-509"><a href="#cb82-509" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> ctrl, <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb82-510"><a href="#cb82-510" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> parameter_grid, <span class="at">metric =</span> <span class="st">"F1"</span>, <span class="at">maximize =</span> <span class="cn">TRUE</span>)</span>
<span id="cb82-511"><a href="#cb82-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-512"><a href="#cb82-512" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test data</span></span>
<span id="cb82-513"><a href="#cb82-513" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(svm_model, <span class="at">newdata =</span> train)</span>
<span id="cb82-514"><a href="#cb82-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-515"><a href="#cb82-515" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a confusion matrix</span></span>
<span id="cb82-516"><a href="#cb82-516" aria-hidden="true" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(predictions, <span class="at">reference =</span> train<span class="sc">$</span>DEPRESSED)</span>
<span id="cb82-517"><a href="#cb82-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-518"><a href="#cb82-518" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the F1 score</span></span>
<span id="cb82-519"><a href="#cb82-519" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> confusion_matrix<span class="sc">$</span>byClass[<span class="st">"F1"</span>]</span>
<span id="cb82-520"><a href="#cb82-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-521"><a href="#cb82-521" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the best parameter combination and the corresponding F1 score</span></span>
<span id="cb82-522"><a href="#cb82-522" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Best Parameters: sigma ="</span>, svm_model<span class="sc">$</span>bestTune<span class="sc">$</span>sigma, <span class="st">"C ="</span>, svm_model<span class="sc">$</span>bestTune<span class="sc">$</span>C))</span>
<span id="cb82-523"><a href="#cb82-523" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"F1 Score:"</span>, f1_score))</span>
<span id="cb82-524"><a href="#cb82-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-525"><a href="#cb82-525" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-526"><a href="#cb82-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-527"><a href="#cb82-527" aria-hidden="true" tabindex="-1"></a><span class="fu">## Support Vector Machine svmLinear</span></span>
<span id="cb82-528"><a href="#cb82-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-529"><a href="#cb82-529" aria-hidden="true" tabindex="-1"></a>We observed a sequence of values from 1 to 10 with an increment of 1 for the regularization parameter in our SVM.</span>
<span id="cb82-530"><a href="#cb82-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-531"><a href="#cb82-531" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Best Parameter: C = 1</span>
<span id="cb82-532"><a href="#cb82-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-533"><a href="#cb82-533" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>F1 Score: 0.879060324825986</span>
<span id="cb82-534"><a href="#cb82-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-535"><a href="#cb82-535" aria-hidden="true" tabindex="-1"></a><span class="in">```{r svmLinear}</span></span>
<span id="cb82-536"><a href="#cb82-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-537"><a href="#cb82-537" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb82-538"><a href="#cb82-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-539"><a href="#cb82-539" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the parameter grid</span></span>
<span id="cb82-540"><a href="#cb82-540" aria-hidden="true" tabindex="-1"></a>parameter_grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">C =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span>))</span>
<span id="cb82-541"><a href="#cb82-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-542"><a href="#cb82-542" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the SVM model with different parameter combinations</span></span>
<span id="cb82-543"><a href="#cb82-543" aria-hidden="true" tabindex="-1"></a>svm_model <span class="ot">&lt;-</span> <span class="fu">train</span>(DEPRESSED <span class="sc">~</span> GENDER <span class="sc">+</span> AGE <span class="sc">+</span> CADMIUM_UGL <span class="sc">+</span> MERCURY_UGL, </span>
<span id="cb82-544"><a href="#cb82-544" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, <span class="at">method =</span> <span class="st">"svmLinear"</span>,</span>
<span id="cb82-545"><a href="#cb82-545" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> ctrl, <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb82-546"><a href="#cb82-546" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> parameter_grid, <span class="at">metric =</span> <span class="st">"F1"</span>, <span class="at">maximize =</span> <span class="cn">TRUE</span>)</span>
<span id="cb82-547"><a href="#cb82-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-548"><a href="#cb82-548" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test data</span></span>
<span id="cb82-549"><a href="#cb82-549" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(svm_model, <span class="at">newdata =</span> train)</span>
<span id="cb82-550"><a href="#cb82-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-551"><a href="#cb82-551" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a confusion matrix</span></span>
<span id="cb82-552"><a href="#cb82-552" aria-hidden="true" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(predictions, <span class="at">reference =</span> train<span class="sc">$</span>DEPRESSED)</span>
<span id="cb82-553"><a href="#cb82-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-554"><a href="#cb82-554" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the F1 score</span></span>
<span id="cb82-555"><a href="#cb82-555" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> confusion_matrix<span class="sc">$</span>byClass[<span class="st">"F1"</span>]</span>
<span id="cb82-556"><a href="#cb82-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-557"><a href="#cb82-557" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the best parameter combination and the corresponding F1 score</span></span>
<span id="cb82-558"><a href="#cb82-558" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Best Parameter: C ="</span>, svm_model<span class="sc">$</span>bestTune<span class="sc">$</span>C))</span>
<span id="cb82-559"><a href="#cb82-559" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"F1 Score:"</span>, f1_score))</span>
<span id="cb82-560"><a href="#cb82-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-561"><a href="#cb82-561" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-562"><a href="#cb82-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-563"><a href="#cb82-563" aria-hidden="true" tabindex="-1"></a><span class="fu">## KNN for all Training Data</span></span>
<span id="cb82-564"><a href="#cb82-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-565"><a href="#cb82-565" aria-hidden="true" tabindex="-1"></a><span class="in">```{r KNN for all of training data}</span></span>
<span id="cb82-566"><a href="#cb82-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-567"><a href="#cb82-567" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb82-568"><a href="#cb82-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-569"><a href="#cb82-569" aria-hidden="true" tabindex="-1"></a><span class="co">#scale the data</span></span>
<span id="cb82-570"><a href="#cb82-570" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> train<span class="sc">%&gt;%</span></span>
<span id="cb82-571"><a href="#cb82-571" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>( AGE<span class="sc">:</span>MERCURY_UGL)</span>
<span id="cb82-572"><a href="#cb82-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-573"><a href="#cb82-573" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span>train<span class="sc">%&gt;%</span></span>
<span id="cb82-574"><a href="#cb82-574" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(GENDER, DEPRESSED)</span>
<span id="cb82-575"><a href="#cb82-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-576"><a href="#cb82-576" aria-hidden="true" tabindex="-1"></a>x_scaled<span class="ot">&lt;-</span><span class="fu">scale</span>(x, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb82-577"><a href="#cb82-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-578"><a href="#cb82-578" aria-hidden="true" tabindex="-1"></a>x_scaled<span class="ot">&lt;-</span><span class="fu">cbind</span>(y,x_scaled)</span>
<span id="cb82-579"><a href="#cb82-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-580"><a href="#cb82-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-581"><a href="#cb82-581" aria-hidden="true" tabindex="-1"></a>KNN_fin <span class="ot">&lt;-</span> <span class="fu">train</span>(DEPRESSED<span class="sc">~</span>., <span class="at">data =</span> x_scaled, <span class="at">tuneGrid=</span><span class="fu">data.frame</span>(<span class="at">k=</span><span class="dv">1</span>),<span class="at">method =</span> <span class="st">"knn"</span>)</span>
<span id="cb82-582"><a href="#cb82-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-583"><a href="#cb82-583" aria-hidden="true" tabindex="-1"></a>KNN_fin.pred<span class="ot">&lt;-</span><span class="fu">predict</span>(KNN_fin,x_scaled)</span>
<span id="cb82-584"><a href="#cb82-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-585"><a href="#cb82-585" aria-hidden="true" tabindex="-1"></a>cm_KNN_fin<span class="ot">&lt;-</span><span class="fu">confusionMatrix</span>(KNN_fin.pred,x_scaled<span class="sc">$</span>DEPRESSED,<span class="at">mode=</span><span class="st">"prec_recall"</span>)</span>
<span id="cb82-586"><a href="#cb82-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-587"><a href="#cb82-587" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> cm_KNN_fin<span class="sc">$</span>byClass[<span class="st">"F1"</span>]</span>
<span id="cb82-588"><a href="#cb82-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-589"><a href="#cb82-589" aria-hidden="true" tabindex="-1"></a>f1</span>
<span id="cb82-590"><a href="#cb82-590" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-591"><a href="#cb82-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-592"><a href="#cb82-592" aria-hidden="true" tabindex="-1"></a><span class="fu"># Test Data</span></span>
<span id="cb82-593"><a href="#cb82-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-594"><a href="#cb82-594" aria-hidden="true" tabindex="-1"></a>We decided to impute the missing values with median as the max data points were far from the majority of data points based on the quantiles.</span>
<span id="cb82-595"><a href="#cb82-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-596"><a href="#cb82-596" aria-hidden="true" tabindex="-1"></a><span class="in">```{r test data clean}</span></span>
<span id="cb82-597"><a href="#cb82-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-598"><a href="#cb82-598" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb82-599"><a href="#cb82-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-600"><a href="#cb82-600" aria-hidden="true" tabindex="-1"></a>test<span class="ot">&lt;-</span>test<span class="sc">%&gt;%</span></span>
<span id="cb82-601"><a href="#cb82-601" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(GENDER,DEPRESSED,<span class="at">.before=</span>SEQN)</span>
<span id="cb82-602"><a href="#cb82-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-603"><a href="#cb82-603" aria-hidden="true" tabindex="-1"></a><span class="co">#decide to use Median over mean, as the MAX are vary far from spread</span></span>
<span id="cb82-604"><a href="#cb82-604" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(test)</span>
<span id="cb82-605"><a href="#cb82-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-606"><a href="#cb82-606" aria-hidden="true" tabindex="-1"></a>test<span class="ot">&lt;-</span>test <span class="sc">%&gt;%</span></span>
<span id="cb82-607"><a href="#cb82-607" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">CADMIUM_UGL =</span> <span class="fu">median</span>(test<span class="sc">$</span>CADMIUM_UGL,<span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb82-608"><a href="#cb82-608" aria-hidden="true" tabindex="-1"></a>                         <span class="at">MERCURY_UGL =</span> <span class="fu">median</span>(test<span class="sc">$</span>MERCURY_UGL,<span class="at">na.rm=</span><span class="cn">TRUE</span>)))</span>
<span id="cb82-609"><a href="#cb82-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-610"><a href="#cb82-610" aria-hidden="true" tabindex="-1"></a><span class="co">#validation that NA are replaced by median </span></span>
<span id="cb82-611"><a href="#cb82-611" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(test))</span>
<span id="cb82-612"><a href="#cb82-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-613"><a href="#cb82-613" aria-hidden="true" tabindex="-1"></a><span class="co">#scale</span></span>
<span id="cb82-614"><a href="#cb82-614" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> test<span class="sc">%&gt;%</span></span>
<span id="cb82-615"><a href="#cb82-615" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>( AGE<span class="sc">:</span>MERCURY_UGL)</span>
<span id="cb82-616"><a href="#cb82-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-617"><a href="#cb82-617" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span>test<span class="sc">%&gt;%</span></span>
<span id="cb82-618"><a href="#cb82-618" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(GENDER, DEPRESSED)</span>
<span id="cb82-619"><a href="#cb82-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-620"><a href="#cb82-620" aria-hidden="true" tabindex="-1"></a>x_scaled<span class="ot">&lt;-</span><span class="fu">scale</span>(x, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb82-621"><a href="#cb82-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-622"><a href="#cb82-622" aria-hidden="true" tabindex="-1"></a>x_scaled<span class="ot">&lt;-</span><span class="fu">cbind</span>(y,x_scaled)</span>
<span id="cb82-623"><a href="#cb82-623" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-624"><a href="#cb82-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-625"><a href="#cb82-625" aria-hidden="true" tabindex="-1"></a><span class="fu">## Prediction on Test Data</span></span>
<span id="cb82-626"><a href="#cb82-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-627"><a href="#cb82-627" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**KNN F1 Score**: 0.846153846153846</span>
<span id="cb82-628"><a href="#cb82-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-629"><a href="#cb82-629" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Random Forest F1 Score**: 0.86454652532391</span>
<span id="cb82-630"><a href="#cb82-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-631"><a href="#cb82-631" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**SVM radial F1 Score**: 0.864896755162242</span>
<span id="cb82-632"><a href="#cb82-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-633"><a href="#cb82-633" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**SVM Linear F1 Score**: 0.866197183098592</span>
<span id="cb82-634"><a href="#cb82-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-635"><a href="#cb82-635" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Test Data Predictions1}</span></span>
<span id="cb82-636"><a href="#cb82-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-637"><a href="#cb82-637" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb82-638"><a href="#cb82-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-639"><a href="#cb82-639" aria-hidden="true" tabindex="-1"></a>knn_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(KNN_fin, <span class="at">newdata =</span> test)</span>
<span id="cb82-640"><a href="#cb82-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-641"><a href="#cb82-641" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a confusion matrix for the test predictions</span></span>
<span id="cb82-642"><a href="#cb82-642" aria-hidden="true" tabindex="-1"></a>knn_confusion_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(knn_predictions, <span class="at">reference =</span> test<span class="sc">$</span>DEPRESSED)</span>
<span id="cb82-643"><a href="#cb82-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-644"><a href="#cb82-644" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the F1 score from the test confusion matrix</span></span>
<span id="cb82-645"><a href="#cb82-645" aria-hidden="true" tabindex="-1"></a>knn_f1_score <span class="ot">&lt;-</span> knn_confusion_matrix<span class="sc">$</span>byClass[<span class="st">"F1"</span>]</span>
<span id="cb82-646"><a href="#cb82-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-647"><a href="#cb82-647" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the F1 score for the test set</span></span>
<span id="cb82-648"><a href="#cb82-648" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"KNN F1 Score:"</span>, knn_f1_score))</span>
<span id="cb82-649"><a href="#cb82-649" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-650"><a href="#cb82-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-651"><a href="#cb82-651" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Test Data Predictions2}</span></span>
<span id="cb82-652"><a href="#cb82-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-653"><a href="#cb82-653" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb82-654"><a href="#cb82-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-655"><a href="#cb82-655" aria-hidden="true" tabindex="-1"></a>rf_fin <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(DEPRESSED <span class="sc">~</span> GENDER <span class="sc">+</span> AGE <span class="sc">+</span> CADMIUM_UGL <span class="sc">+</span> MERCURY_UGL,</span>
<span id="cb82-656"><a href="#cb82-656" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> train_rf, <span class="at">ntree =</span> <span class="dv">20</span>, <span class="at">mtry =</span> <span class="dv">1</span>)</span>
<span id="cb82-657"><a href="#cb82-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-658"><a href="#cb82-658" aria-hidden="true" tabindex="-1"></a>rf_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_fin, <span class="at">newdata =</span> test)</span>
<span id="cb82-659"><a href="#cb82-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-660"><a href="#cb82-660" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a confusion matrix for the test predictions</span></span>
<span id="cb82-661"><a href="#cb82-661" aria-hidden="true" tabindex="-1"></a>rf_confusion_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(rf_predictions, <span class="at">reference =</span> test<span class="sc">$</span>DEPRESSED)</span>
<span id="cb82-662"><a href="#cb82-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-663"><a href="#cb82-663" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the F1 score from the test confusion matrix</span></span>
<span id="cb82-664"><a href="#cb82-664" aria-hidden="true" tabindex="-1"></a>rf_f1_score <span class="ot">&lt;-</span> rf_confusion_matrix<span class="sc">$</span>byClass[<span class="st">"F1"</span>]</span>
<span id="cb82-665"><a href="#cb82-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-666"><a href="#cb82-666" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the F1 score for the test set</span></span>
<span id="cb82-667"><a href="#cb82-667" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Random Forest F1 Score:"</span>, rf_f1_score))</span>
<span id="cb82-668"><a href="#cb82-668" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-669"><a href="#cb82-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-670"><a href="#cb82-670" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Test Data Predictions3}</span></span>
<span id="cb82-671"><a href="#cb82-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-672"><a href="#cb82-672" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb82-673"><a href="#cb82-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-674"><a href="#cb82-674" aria-hidden="true" tabindex="-1"></a>svmrad_model <span class="ot">&lt;-</span> <span class="fu">train</span>(DEPRESSED <span class="sc">~</span> GENDER <span class="sc">+</span> AGE <span class="sc">+</span> CADMIUM_UGL <span class="sc">+</span> MERCURY_UGL, </span>
<span id="cb82-675"><a href="#cb82-675" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb82-676"><a href="#cb82-676" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"svmRadial"</span>,</span>
<span id="cb82-677"><a href="#cb82-677" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> ctrl,</span>
<span id="cb82-678"><a href="#cb82-678" aria-hidden="true" tabindex="-1"></a>                   <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb82-679"><a href="#cb82-679" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneLength =</span> <span class="dv">1</span>,  <span class="co"># Set the number of hyperparameter combinations to 1</span></span>
<span id="cb82-680"><a href="#cb82-680" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> <span class="fu">data.frame</span>(<span class="at">sigma =</span> <span class="fl">0.8</span>, <span class="at">C =</span> <span class="dv">1</span>),  <span class="co"># Set sigma and C values</span></span>
<span id="cb82-681"><a href="#cb82-681" aria-hidden="true" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">"F1"</span>,</span>
<span id="cb82-682"><a href="#cb82-682" aria-hidden="true" tabindex="-1"></a>                   <span class="at">maximize =</span> <span class="cn">TRUE</span>)</span>
<span id="cb82-683"><a href="#cb82-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-684"><a href="#cb82-684" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test data</span></span>
<span id="cb82-685"><a href="#cb82-685" aria-hidden="true" tabindex="-1"></a>svmrad_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(svmrad_model, <span class="at">newdata =</span> test)</span>
<span id="cb82-686"><a href="#cb82-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-687"><a href="#cb82-687" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a confusion matrix for the test predictions</span></span>
<span id="cb82-688"><a href="#cb82-688" aria-hidden="true" tabindex="-1"></a>svmrad_confusion_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(svmrad_predictions, <span class="at">reference =</span> test<span class="sc">$</span>DEPRESSED)</span>
<span id="cb82-689"><a href="#cb82-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-690"><a href="#cb82-690" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the F1 score from the test confusion matrix</span></span>
<span id="cb82-691"><a href="#cb82-691" aria-hidden="true" tabindex="-1"></a>svmrad_f1_score <span class="ot">&lt;-</span> svmrad_confusion_matrix<span class="sc">$</span>byClass[<span class="st">"F1"</span>]</span>
<span id="cb82-692"><a href="#cb82-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-693"><a href="#cb82-693" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the F1 score for the test set</span></span>
<span id="cb82-694"><a href="#cb82-694" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"SVM Radial F1 Score:"</span>, svmrad_f1_score))</span>
<span id="cb82-695"><a href="#cb82-695" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-696"><a href="#cb82-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-699"><a href="#cb82-699" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb82-700"><a href="#cb82-700" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb82-701"><a href="#cb82-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-702"><a href="#cb82-702" aria-hidden="true" tabindex="-1"></a>svmlin_model <span class="ot">&lt;-</span> <span class="fu">train</span>(DEPRESSED <span class="sc">~</span> GENDER <span class="sc">+</span> AGE <span class="sc">+</span> CADMIUM_UGL <span class="sc">+</span> MERCURY_UGL, </span>
<span id="cb82-703"><a href="#cb82-703" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb82-704"><a href="#cb82-704" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"svmLinear"</span>,</span>
<span id="cb82-705"><a href="#cb82-705" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> ctrl,</span>
<span id="cb82-706"><a href="#cb82-706" aria-hidden="true" tabindex="-1"></a>                   <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>),</span>
<span id="cb82-707"><a href="#cb82-707" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneLength =</span> <span class="dv">1</span>,  <span class="co"># Set the number of hyperparameter combinations to 1</span></span>
<span id="cb82-708"><a href="#cb82-708" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> <span class="fu">data.frame</span>(<span class="at">C =</span> <span class="dv">1</span>),  <span class="co"># Set the value for C</span></span>
<span id="cb82-709"><a href="#cb82-709" aria-hidden="true" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">"F1"</span>,</span>
<span id="cb82-710"><a href="#cb82-710" aria-hidden="true" tabindex="-1"></a>                   <span class="at">maximize =</span> <span class="cn">TRUE</span>)</span>
<span id="cb82-711"><a href="#cb82-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-712"><a href="#cb82-712" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test data</span></span>
<span id="cb82-713"><a href="#cb82-713" aria-hidden="true" tabindex="-1"></a>svmlin_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(svmlin_model, <span class="at">newdata =</span> test)</span>
<span id="cb82-714"><a href="#cb82-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-715"><a href="#cb82-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-716"><a href="#cb82-716" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a confusion matrix for the test predictions</span></span>
<span id="cb82-717"><a href="#cb82-717" aria-hidden="true" tabindex="-1"></a>svmlin_confusion_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(svmlin_predictions, <span class="at">reference =</span> test<span class="sc">$</span>DEPRESSED)</span>
<span id="cb82-718"><a href="#cb82-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-719"><a href="#cb82-719" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the F1 score from the test confusion matrix</span></span>
<span id="cb82-720"><a href="#cb82-720" aria-hidden="true" tabindex="-1"></a>svmlin_f1_score <span class="ot">&lt;-</span> svmlin_confusion_matrix<span class="sc">$</span>byClass[<span class="st">"F1"</span>]</span>
<span id="cb82-721"><a href="#cb82-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-722"><a href="#cb82-722" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the F1 score for the test set</span></span>
<span id="cb82-723"><a href="#cb82-723" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"SVM Linear F1 Score:"</span>, svmlin_f1_score))</span>
<span id="cb82-724"><a href="#cb82-724" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb82-725"><a href="#cb82-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-726"><a href="#cb82-726" aria-hidden="true" tabindex="-1"></a><span class="fu"># **Comparing Models**</span></span>
<span id="cb82-727"><a href="#cb82-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-728"><a href="#cb82-728" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>KNN:</span>
<span id="cb82-729"><a href="#cb82-729" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Overfitting and Underfitting:</span>
<span id="cb82-730"><a href="#cb82-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-731"><a href="#cb82-731" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>KNN can suffer from overfitting when the value of k is too small, leading to excessive complexity and potentially memorizing the training data. On the other hand, with a large value of k, KNN may underfit and fail to capture the underlying patterns in the data.</span>
<span id="cb82-732"><a href="#cb82-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-733"><a href="#cb82-733" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Bias vs Variance Tradeoff:</span>
<span id="cb82-734"><a href="#cb82-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-735"><a href="#cb82-735" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>KNN tends to have low bias but can have high variance, especially when k is small. As k increases, the model becomes more biased but also reduces its variance.</span>
<span id="cb82-736"><a href="#cb82-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-737"><a href="#cb82-737" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Flexibility vs Interpretability:</span>
<span id="cb82-738"><a href="#cb82-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-739"><a href="#cb82-739" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>KNN is a flexible model that can capture complex relationships in the data. However, it is less interpretable compared to other models as it relies on the similarity of data points rather than explicit rules or coefficients.</span>
<span id="cb82-740"><a href="#cb82-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-741"><a href="#cb82-741" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>In our project, k = 1 gave the best F1 score of 0.9904793. This suggests our model is overfitted and has low bias with high variance. As the value of our k value increases the F1 score decreases.</span>
<span id="cb82-742"><a href="#cb82-742" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Random Forest:</span>
<span id="cb82-743"><a href="#cb82-743" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Overfitting and Underfitting:</span>
<span id="cb82-744"><a href="#cb82-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-745"><a href="#cb82-745" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Random Forests are less prone to overfitting due to the ensemble nature of combining multiple decision trees. However, it can still overfit if the number of trees is very large or if individual trees are allowed to grow excessively deep.</span>
<span id="cb82-746"><a href="#cb82-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-747"><a href="#cb82-747" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Bias vs Variance Tradeoff:</span>
<span id="cb82-748"><a href="#cb82-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-749"><a href="#cb82-749" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Random Forests strike a balance between bias and variance by aggregating multiple decision trees. The individual trees in the ensemble tend to have high variance but when combined, the overall model has lower variance.</span>
<span id="cb82-750"><a href="#cb82-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-751"><a href="#cb82-751" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Flexibility vs Interpretability:</span>
<span id="cb82-752"><a href="#cb82-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-753"><a href="#cb82-753" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Random Forests offer a good balance between flexibility and interpretability. They can capture complex interactions in the data while also providing feature importances for interpretability.</span>
<span id="cb82-754"><a href="#cb82-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-755"><a href="#cb82-755" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>In our project we observed 20 to 100 trees with an increment of 20 in our random forest model and 6 different hyper-parameter control values of 1 -6. Regardless of the number of trees, the best F1 score was obtained through the hyper-parameter value of 1. As the number of individual trees increase, we notice how our F1 scores decrease, which may suggest that the model does not suffer much overfitting.</span>
<span id="cb82-756"><a href="#cb82-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-757"><a href="#cb82-757" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>However, we find it interesting that the F1 scores remain consistent when we increment our trees by 20 from 20 - 100. This observation can be further studied to better the random forest model.</span>
<span id="cb82-758"><a href="#cb82-758" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>SVM (Radial):</span>
<span id="cb82-759"><a href="#cb82-759" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Overfitting and Underfitting:</span>
<span id="cb82-760"><a href="#cb82-760" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>SVM with a radial kernel can be prone to overfitting if the kernel parameters, such as sigma, are not properly tuned. If the kernel parameters are chosen poorly, the model may fail to generalize well to unseen data.</span>
<span id="cb82-761"><a href="#cb82-761" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Bias vs Variance Tradeoff:</span>
<span id="cb82-762"><a href="#cb82-762" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>SVM with a radial kernel can have a high flexibility and may capture complex patterns in the data. However, if the model is excessively flexible due to incorrect parameter choices, it can have high variance.</span>
<span id="cb82-763"><a href="#cb82-763" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Flexibility vs Interpretability:</span>
<span id="cb82-764"><a href="#cb82-764" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>SVM with a radial kernel is more flexible and can capture non-linear relationships in the data. However, the resulting model may be less interpretable compared to linear models.</span>
<span id="cb82-765"><a href="#cb82-765" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>In our project, we observed a sequence of values from 0.1 to 1 with an increment of 0.1 for the width of the RBF kernel. Additionally, we observed a sequence of values from 1 to 10 with an increment of 1 for the regularization parameter in our SVM.</span>
<span id="cb82-766"><a href="#cb82-766" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>SVM (Linear):</span>
<span id="cb82-767"><a href="#cb82-767" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Overfitting and Underfitting:</span>
<span id="cb82-768"><a href="#cb82-768" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>SVM with a linear kernel is less prone to overfitting compared to models with more flexible kernels. However, it can still overfit if the regularization parameter (C) is set too small or if the data has a large number of features compared to the number of samples.</span>
<span id="cb82-769"><a href="#cb82-769" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Bias vs Variance Tradeoff:</span>
<span id="cb82-770"><a href="#cb82-770" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>SVM with a linear kernel tends to have lower variance but can have a higher bias compared to more flexible models. It relies on finding the optimal hyperplane to separate the classes, which may not capture complex relationships.</span>
<span id="cb82-771"><a href="#cb82-771" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Flexibility vs Interpretability:</span>
<span id="cb82-772"><a href="#cb82-772" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>SVM with a linear kernel strikes a balance between flexibility and interpretability. It can capture linear relationships in the data while providing interpretable coefficients for each feature.</span>
<span id="cb82-773"><a href="#cb82-773" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>We observed a sequence of values from 1 to 10 with an increment of 1 for the regularization parameter in our SVM. SVM with a radial kernel are more prone to overfitting when compared to SVM with a linear kernel. In general, SVM with a radial kernel is more flexible and can capture non-linear data more aptly. However, in our model we notice how the svmRadial and svmLinear approaches yield virtually the same F1 scores. This could suggest that the data contains linear relationships.</span>
<span id="cb82-774"><a href="#cb82-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-775"><a href="#cb82-775" aria-hidden="true" tabindex="-1"></a>In summary, the Random Forest model generally performs well in terms of overfitting and bias-variance tradeoff due to its ensemble nature. SVM with a linear kernel and KNN also show similar performance in terms of overfitting and bias-variance tradeoff. However, Random Forest and SVM with a radial kernel offer more flexibility in capturing complex patterns, while SVM with a linear kernel provides better interpretability with its coefficients.</span>
<span id="cb82-776"><a href="#cb82-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-777"><a href="#cb82-777" aria-hidden="true" tabindex="-1"></a><span class="fu"># Ethical Consideration</span></span>
<span id="cb82-778"><a href="#cb82-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-779"><a href="#cb82-779" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>HIPAA Violation:</span>
<span id="cb82-780"><a href="#cb82-780" aria-hidden="true" tabindex="-1"></a><span class="ss">    1.  </span>With the understanding of heavy metals in urine and blood as a predictor of depression, a provider may have bias towards their patients. If a patient received labs for blood or urine analysis, the test may show the levels of heavy metals in their samples. A provider who observes the presence of the metals may form (un)conscious biases towards their patients. This could lead to potential HIPAA violations if a provider that is not in the scope of practice decided to investigate patients' non-disclosed mental health status.</span>
<span id="cb82-781"><a href="#cb82-781" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Hazard Transparency:</span>
<span id="cb82-782"><a href="#cb82-782" aria-hidden="true" tabindex="-1"></a><span class="ss">    1.  </span>Heavy metals are commonly bio-accumulated through inhalation. Trace amounts of these metals can be IN THE AIR. Workers who are at higher risk of heavy metal inhalation due to their work environment should be properly informed of risk. If predictions between heavy metals and depression are known but obscured from employees, the workers may develop mental health concerns due to their work environment, but be unaware.</span>
<span id="cb82-783"><a href="#cb82-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-784"><a href="#cb82-784" aria-hidden="true" tabindex="-1"></a><span class="fu"># Concluding Remarks</span></span>
<span id="cb82-785"><a href="#cb82-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-786"><a href="#cb82-786" aria-hidden="true" tabindex="-1"></a>We found that there is a statistically significant effect of Cadmium and Mercury between depressed and non-depressed groups. While running the models on the training set, KNN performed the best. However, when we compared the models using the test set, the difference in the F1 scores was minor, though the svmLinear performed slightly better.</span>
<span id="cb82-787"><a href="#cb82-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-788"><a href="#cb82-788" aria-hidden="true" tabindex="-1"></a><span class="fu"># **Sources Referenced**:</span></span>
<span id="cb82-789"><a href="#cb82-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-790"><a href="#cb82-790" aria-hidden="true" tabindex="-1"></a>ChatGPT, personal communication, May 23, 2023</span>
<span id="cb82-791"><a href="#cb82-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-792"><a href="#cb82-792" aria-hidden="true" tabindex="-1"></a>Oskar S, Stingone JA. Machine Learning Within Studies of Early-Life Environmental Exposures and Child Health: Review of the Current Literature and Discussion of Next Steps. Curr Environ Health Rep. 2020 Sep;7(3):170-184. doi: 10.1007/s40572-020-00282-5. PMID: 32578067; PMCID: PMC7483339.</span>
<span id="cb82-793"><a href="#cb82-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-794"><a href="#cb82-794" aria-hidden="true" tabindex="-1"></a>Posit team (2023). RStudio: Integrated Development Environment for R. Posit Software, PBC, Boston, MA. URL http://www.posit.co/.</span>
<span id="cb82-795"><a href="#cb82-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-796"><a href="#cb82-796" aria-hidden="true" tabindex="-1"></a>Xia F, Li Q, Luo X, Wu J. Machine learning model for depression based on heavy metals among aging people: A study with National Health and Nutrition Examination Survey 2017-2018. Front Public Health. 2022 Aug 4;10:939758. doi: 10.3389/fpubh.2022.939758. PMID: 35991018; PMCID: PMC9386350.</span>
<span id="cb82-797"><a href="#cb82-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-798"><a href="#cb82-798" aria-hidden="true" tabindex="-1"></a>Xihang Fu, Huiru Li, Lingling Song, Manqiu Cen, Jing Wu, Association of urinary heavy metals co-exposure and adult depression: Modification of physical activity, NeuroToxicology, Volume 95,2023,Pages 117-12 ISSN 0161-813X,https://doi.org/10.1016/j.neuro.2023.01.008</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>